<div class="ui-g " [formGroup]="TUBING" *ngIf="PageFlag.page =='AssignTask'">
  <!--Strain -->
  <div class="ui-g-12 ui-md-6">
      <div class="paddingRL">
          <label for="strain">{{ globalResource.strain }} <span class="star">*</span></label>
        <div class="clear"></div>
          <p-dropdown
            [filter] ="true"
            [options]="strains"
            [(ngModel)]="TaskModel.TUBING.strain"
            (onChange)="onStrainChange()"
            placeholder="-- Select --"
            [autoWidth]="true"
            [readonly]="readonlyFlag"
            formControlName="strain"
            class="clsControl"
            id="strain"
            name="strain">
        </p-dropdown>
        <div
          class="ui-message ui-messages-error ui-corner-all" appErrorTooltip
          *ngIf="!TUBING.controls['strain'].valid&&TUBING.controls['strain'].dirty">
          
            <span *ngIf="TUBING.controls['strain'].errors['required']">
              {{ globalResource.strainrequired }}
            </span>                      
        </div>

      </div>
    </div>
    <!--End Strain -->   
    
    <!--Employee-->
    <div class="ui-g-12 ui-md-6">
        <div class="paddingRL">
          <label for="employee">{{ globalResource.employee }} <span class="star">*</span></label>
  
            <p-dropdown
            [filter] ="true"
              [options]="employees"
              [(ngModel)]="TaskModel.TUBING.employee"
              class="clsControl"
              formControlName="employee"
              [readonly]="readonlyEmployeeFlag"
              id="employee"
              name="employee">
          </p-dropdown>
  
          <div
            class="ui-message ui-messages-error ui-corner-all" appErrorTooltip
            *ngIf="!TUBING.controls['employee'].valid&&TUBING.controls['employee'].dirty">
              <i class="fa fa-close"></i>
              <span *ngIf="TUBING.controls['employee'].errors['required']">
                {{ globalResource.employeerequired }}
              </span>
          </div>
        </div>
    </div>
    <!--End Employee-->
    <!-- Order Details -->
    <div class="ui-g-12" *ngIf="jointsOrderPackets?.controls.length" formArrayName="jointsOrderPackets">
      <h5>Assign Details</h5>
      <p-table [value]="jointsOrderPackets?.controls">
          <ng-template pTemplate="header">
              <tr>                  
                  <th style="width:15%">{{globalResource.pkgtype}}</th>
                  <th style="width:15%">{{globalResource.pkgsize}}</th>
                  <th style="width:15%">{{globalResource.itemqty}}</th>
                  <th style="width:15%">{{globalResource.reqtubes}}</th>                  
                  <th style="width:15%">{{globalResource.assigntubes}}</th>
              </tr>
          </ng-template>
          <ng-template pTemplate="body" let-jointsOrderPacket let-i="rowIndex" >
              <tr [formGroupName]="i">
                  <td>{{orderDetails[i].PkgTypeName}}</td>
                  <td>{{orderDetails[i].UnitValue}} {{globalResource.listgramunit}}</td>
                  <td>{{orderDetails[i].ItemQty}}</td>
                  <td>{{orderDetails[i].RequiredQty}}</td>                  
                  <td>
                    <input
                      type="number"                       
                      maxLength="AppConstants.maxLength"
                      
                      pKeyFilter="pint"
                      pInputText
                      autocomplete="off"
                      formControlName="assignQty"
                      id="answer"
                      name="answer"
                      style="width:100%;"
                    />
                    <!-- (change)="assignQtyOnChange(jointsOrderPacket, orderDetails[i].RequiredQty)" -->
                  </td>
              </tr>
          </ng-template>
          <ng-template pTemplate="emptymessage" let-columns>
            <tr>
                <td [attr.colspan]="5">
                   {{ globalResource.norecordsfound }}
                </td>
            </tr>
          </ng-template>
      </p-table>

      <!-- <div class="text-right">
        <button type="submit" pButton icon="fa-check"  label="Confirm" ></button>
      </div> -->
    </div>
    <!--End Order Details -->
    <div class="ui-g-12" *ngIf="jointsOrderPackets?.controls.length" >
        <h5>Select Lots For Strain</h5>

        <p-table [value]="orderDetailsBS_filteredData">
            <ng-template pTemplate="header">
                <tr>
                    <!-- <th style="width:20%">{{globalResource.brand}}</th> -->
                    <th style="width:20%">{{globalResource.strain}}</th>
                    <!-- <th style="width:20%">Lot Ids</th> -->
                    <th style="width:80%">{{globalResource.lotdetails}}</th>
                    <!-- <th style="width:20%">Selected Weight</th> -->
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-orderDetail let-rowIndex="rowIndex">
                <tr>
                    <!-- <td>{{orderDetail?.BrandName}}</td> -->
                    <td>{{orderDetail?.StrainName}}</td>
                    <!-- <td> <a [routerLink]="" (click)="openLotSelection(orderDetail?.BrandId, orderDetail?.StrainId, rowIndex)" >Select Lots</a> </td> -->
                    <td>                      
                        <p-table [value]="selectedLotsArray[rowIndex]">
                            <ng-template pTemplate="header">
                                <tr>
                                    <th>{{ globalResource.strain }}</th>
                                    <th class="lotNum">{{ globalResource.lotno}}</th>
                                    <th>{{ globalResource.pkgsize }}</th>
                                    <th>{{ globalResource.selectedjointsqty }}</th>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-lotDetails >
                                <tr>
                                    <td><span>{{lotDetails.StrainName}}</span></td>
                                    <td class="lotNum"><span>{{lotDetails.GrowerLotNo}}</span></td>
                                    <td>{{lotDetails.UnitValue}} {{globalResource.listgramunit}}</td>
                                    <td>{{lotDetails.SelectedQty}}</td>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="emptymessage">
                              <tr>
                                  <td [attr.colspan]="4">
                                    {{ globalResource.norecordsfound }}
                                  </td>
                              </tr>
                            </ng-template>
                        </p-table>
                        <span  *ngIf="orderDetail.LotCount > 0" >
                          <a class="btn-link" [routerLink]="" (click)="openLotSelection(orderDetail, rowIndex)" >Select Lots</a>
                        </span>
                        <span class="star"  *ngIf="orderDetail.LotCount === 0" >
                            {{ globalResource.lotnotavailable }}  
                          </span>
                    </td>
                </tr>
            </ng-template>
        </p-table>
    </div>
  <!--Estimated Start Date-->
  <div class="ui-g-12 ui-md-6">
      <div class="paddingRL">
        <label for="estimatedstartdatetime">
          {{ globalResource.eststartdate }} <span class="star">*</span>
        </label>
        <small class="smallTextRed"
          *ngIf="showPastDateLabel"
          >({{ globalResource.pastdatetask }})
        </small>
          <p-calendar
            [(ngModel)]="TaskModel.TUBING.startdate"
            [showIcon]="true"
            [defaultDate]="defaultDate"
            (onSelect)="estStartDate_Select()"
            (onInput)="estStartDate_Select()"
            formControlName="estimatedstartdate"
            class="clsControl"
            id="estimatedstartdate"
            name="estimatedstartdate"
         >
       </p-calendar>
          <div
            class="ui-message ui-messages-error ui-corner-all" appErrorTooltip
            *ngIf="!TUBING.controls['estimatedstartdate'].valid&&TUBING.controls['estimatedstartdate'].dirty">
              <i class="fa fa-close"></i>
              <span *ngIf="TUBING.controls['estimatedstartdate'].errors['required']">
                {{ globalResource.startdaterequired }}
              </span>
          </div>

          <div class="ui-message ui-messages-error ui-corner-all" appErrorTooltip
            *ngIf="TUBING.hasError('invalidDate')" >
              {{ globalResource.datecomparevalidation }}
          </div>
      </div>
  </div>
  <!--End Estimated Start Date-->

   <!--Priority-->
   <div class="ui-g-12 ui-md-6">
      <div class="paddingRL">
      <label for="employee">{{ globalResource.priority }}</label>

      <p-dropdown
        [options]="priorities"
        [(ngModel)]="TaskModel.TUBING.priority"
        [autoWidth]="true"
        formControlName="priority"
        id="priority"
        class="clsControl"
        name="priority">
      </p-dropdown>
    </div>
  </div>
  <!--End Priority-->

  <!--Notify Manager/Employee-->
  <div class="ui-g-12 ui-md-6">
      <div class="paddingRL">
          <label ></label>
        <div class="clear"></div>

          <p-checkbox
            value="chkManagerCheck"
            label="{{ assignTaskResources.notifymanager }}"
            [(ngModel)]="TaskModel.TUBING.notifymanager"
            formControlName="notifymanager"
            binary="true"
          ></p-checkbox>

          <p-checkbox
            value="chkEmployeeCheck"
            label="{{ assignTaskResources.notifyemployee }}"
            [(ngModel)]="TaskModel.TUBING.notifyemployee"
            formControlName="notifyemployee"
            binary="true"
          ></p-checkbox>
      </div>
  </div>
  <!--End Notify Manager/Employee-->
  <!--Comment-->
  <div class="ui-g-12 ui-md-6">
      <div class="paddingRL">
        <label for="comment">{{ assignTaskResources.comment }}</label>

          <textarea
            pInputTextarea
            [(ngModel)]="TaskModel.TUBING.usercomment"
            formControlName="comment"
            id="comment"
            name="comment"
            class="clsControl"
            maxlength="500"
          ></textarea>

          <div
            class="ui-message ui-messages-error ui-corner-all" appErrorTooltip
            *ngIf="!TUBING.controls['comment'].valid&&TUBING.controls['comment'].dirty">
              <i class="fa fa-close"></i>
              <span *ngIf="TUBING.controls['comment'].errors['maxLength']">
                {{ assignTaskResources.commentMaxLength }}
              </span>
        </div>
      </div>
    </div>
    <!--End Comment-->

    <p-dialog header="Select Lots"
    [(visible)]="showLotSelectionModel"
    modal="modal"
    [resizable]="true"
    [responsive]="true" [width]="600" [minWidth]="300" [blockScroll]="true" >

      <form [formGroup]="questionForm" (ngSubmit)="submit(questionForm)" formSubmit>
    <div class="ui-grid ui-grid-responsive ui-grid-pad ui-fluid" style="margin: 10px 0px">

      <div class="ui-g">

               <div class="ui-g-12 ui-md-6">
                  <label>
                      <strong>{{ globalResource.genetics }}</strong>
                    </label>

                    <label>
                      {{ selLotBrandStrainRow?.GeneticsName }}
                    </label>
                </div>

                <div class="ui-g-12">
                    <!-- <label>
                      <strong>{{ globalResource.requiredqty }}</strong>
                    </label>

                    <label>
                      {{ selLotBrandStrainRow?.combinationTotalAssignedQty }}
                    </label> -->
                    <p-table [value]="selLotBrandStrainRow?.pkgSizeRequiredQtyArr">
                        <ng-template pTemplate="header">
                            <tr>
                                <th>{{ globalResource.pkgsize }}</th>
                                <th>{{ globalResource.requiredjointsqty }}</th>                                   
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="body" let-details>
                            <tr>
                                <td>{{details.UnitValue}} {{globalResource.listgramunit}}</td>
                                <td>{{details.RequiredQty}}</td>
                            </tr>
                        </ng-template>
                    </p-table>
                </div>

        </div>
        <div formArrayName="questions">
        <p-table [value]="questions?.controls">
            <ng-template pTemplate="header">
                <tr>
                    <th style="width:20%">{{ globalResource.strain }}</th>
                    <th style="width:230px">{{globalResource.lotno}}</th>
                    <th style="width:20%">{{ globalResource.pkgsize }} {{ globalResource.listgramunit }}</th>
                    <th style="width:20%">{{ globalResource.availjointsqty }}</th>
                    <th style="width:20%">{{globalResource.selectedjointsqty}}</th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-question let-i="rowIndex" >
                <tr [formGroupName]="i">
                    <td> {{ brandStrainLots[i].StrainName  }} </td>
                    <td style="width:230px">
                        <p-checkbox
                          label="{{ brandStrainLots[i].GrowerLotNo  }}"
                          formControlName="question"
                          (ngModelChange)="changeValidator($event, i)"
                          binary="true"
                        ></p-checkbox>

                        <app-lot-comment
                            [LotId]="question.value.LotNo"
                            [LotCommentsCount]="brandStrainLots[i].LotNoteCount"
                            (CommentIconClicked)="commentIconClicked($event)"
                        ></app-lot-comment>

                        <app-lot-note-icon
                          [LotId]="question.value.LotNo"                              
                          (NoteIconClicked)="showLotNote($event)"
                        ></app-lot-note-icon>
                                                
                    </td>
                    <td> {{ brandStrainLots[i].UnitValue  }} {{globalResource.listgramunit}}</td>
                    <td> {{ brandStrainLots[i].Qty  }} </td>
                    <td>
                      <input
                        type="number"
                        pKeyFilter="pint"
                        pInputText
                        autocomplete="off"
                        formControlName="answer"
                        id="answer"
                        name="answer"
                        style="width:100%;"
                    />
                    </td>
                </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage" >
              <tr>
                  <td [attr.colspan]="5">
                      {{ assignTaskResources.notampedjointslotavail }} "{{ selLotBrandStrainRow?.StrainName }}".
                  </td>
              </tr>
            </ng-template>
        </p-table>
        </div>
        <!-- do not delete below commented code -->
          <!-- <div formArrayName="questions">
            <div *ngFor="let question of questions?.controls; let i = index;" [formGroupName]="i">
              {{questionForm.get('questions.' + i + '.questionNumber').value}}
               {{questions[questionForm.get('questions.' + i + '.questionNumber').value - 1]['EN']}}
              <p-checkbox
                label="{{ brandStrainLots[i].GrowerLotNo  }}"
                formControlName="question"
                (ngModelChange)="changeValidator($event, i)"
                binary="true"
              ></p-checkbox>
              {{ brandStrainLots[i].AvailableWt  }}
              <input type="checkbox" formControlName="question" (ngModelChange)="changeValidator($event, i)"/>
              <input type="text" formControlName="answer" />

              <input
                type="text"
                OnlyNumber="true"
                pInputText
                formControlName="answer"
                id="answer"
                name="answer"
                style="width:30%;"
              />
              <em *ngIf="questionForm.get('questions.' + i + '.answer').invalid">Minimum length 4</em>
            </div>
          </div>   -->

        <!-- {{brandStrainLots?[0] | json }} -->

        <!-- {{ lotSelectionForm.value | json }} -->
      </div>
      <p-footer class="text-right">

        <button type="submit" pButton icon="fa-check"  label="Confirm" ></button>
        <!-- [disabled]="questionForm.invalid" -->
        <button type="button" pButton icon="fa-close" (click)="showLotSelectionModel=false" label="Cancel"></button>
    </p-footer>
  </form>
    </p-dialog>
  </div>

  <app-lot-note [Lot]="lotInfo" *ngIf="lotInfo?.showLotNoteModal" (NoteSaved)="onNoteSave($event)" ></app-lot-note> 
  <app-popup-lot-comment [Lot]="lotInfo" *ngIf="lotInfo?.showLotCommentModal" (CommentSaved)="OnCommentSaved($event)">
    </app-popup-lot-comment>

  <div *ngIf="PageFlag.page =='TaskAction'">
    <div class="ui-g">
      <!--Employee -->
   <div class="ui-g-12 ui-md-6">
    <div class="paddingRL">
        <label>
          <strong>{{ globalResource.employee }}: </strong>
        </label>

        <label>
          {{TaskModel?.EmpName}}
        </label>
      </div>
    </div>
    <!--End Employee -->   
    <!--Estimated Start DateTime-->
    <div class="ui-g-12 ui-md-6">
      <div class="paddingRL">
          <label>
            <strong>{{ globalResource.eststartdate }}: </strong>
          </label>

            {{TaskModel?.EstStartDate }}
        </div>
      </div>
      <!--End Estimated Start DateTime-->

     <!--Actual Start DateTime-->
     <div class="ui-g-12 ui-md-6" *ngIf="TaskModel?.TaskStatus !== taskStatus.Assigned&&TaskModel?.TaskStatus !== ''" >
        <div class="paddingRL">
            <label>
              <strong>{{ globalResource.actualstartdate }}: </strong>
            </label>

              {{TaskModel?.ActStartDate }}
          </div>
        </div>
        <!--End Actual Start DateTime-->

      <!--Actual End DateTime-->
      <div class="ui-g-12 ui-md-6" *ngIf="TaskModel?.TaskStatus !== taskStatus.Assigned&&TaskModel?.TaskStatus !== ''">
        <div class="paddingRL">
          <label>
            <strong>{{ globalResource.actualenddate }}: </strong>
          </label>

            {{TaskModel?.ActEndDate}}
        </div>
      </div>
      <!--End Actual End DateTime-->

     <!--Actual cost-->
     <div class="ui-g-12 ui-md-6" *ngIf="(TaskModel?.TaskStatus === taskStatus.Completed||TaskModel?.TaskStatus === taskStatus.ReviewPending)&&TaskModel?.TaskStatus !== ''">
        <div class="paddingRL">
            <label>
              <strong>{{ assignTaskResources.actualcost }}: </strong>
            </label>
         
              {{TaskModel?.EmpFinalCost | currency }}
          </div>
        </div>
      <!--End Actual costs-->

    <!--Priority -->
    <div class="ui-g-12 ui-md-6">
      <div class="paddingRL">
          <label>
            <strong>{{ globalResource.priority }}: </strong>
          </label>

          {{TaskModel?.TaskPriority}}
        </div>
      </div>
      <!--End Priority -->

     <!--Misc. Cost-->
     <div class="ui-g-12 ui-md-6" *ngIf="TaskModel?.TaskStatus === taskStatus.Completed" >
        <div class="paddingRL">
            <label>
              <strong>{{ globalResource.misccost }}: </strong>
            </label>

              {{taskReviewModel?.rmisccost | currency }}
          </div>
        </div>
        <!--End Misc. Cost-->
        <div class="ui-g-12" >
          <h5>Assigned Details</h5>
          <p-table [value]="TaskModel?.AssignQtyDetails">
              <ng-template pTemplate="header">
                  <tr>                     
                      <th style="width:20%">{{globalResource.strain}}</th>
                      <th style="width:20%">{{globalResource.pkgtype}}</th>
                      <th style="width:20%">{{globalResource.pkgsize}}</th>
                      <th style="width:20%">{{globalResource.itemqty}}</th>
                      <!-- <th style="width:20%">Order Qty</th> -->
                      <th style="width:20%">{{globalResource.assignedpkgqty}}</th>
                      <th style="width:20%" *ngIf="(TaskModel?.TaskStatus === taskStatus.Completed||TaskModel?.TaskStatus === taskStatus.ReviewPending)&&TaskModel?.TaskStatus !== ''">
                        {{globalResource.completedqty}}
                      </th>
                      <th style="width:20%" *ngIf="showToManager">{{globalResource.revqty}}</th>
                  </tr>
              </ng-template>
              <ng-template pTemplate="body" let-details let-i="rowIndex" >
                  <tr >                    
                      <td>{{details.StrainName}}</td>
                      <td>{{details.PkgTypeName}}</td>
                      <td>{{details.UnitValue}} {{globalResource.listgramunit}}</td>
                      <td>{{details.ItemQty}}</td>
                      <td>{{details.AssignedQty}}</td>                                                
                      <td 
                        pTooltip="View Completion Details" tooltipPosition="left"
                        *ngIf="(TaskModel?.TaskStatus === taskStatus.Completed||TaskModel?.TaskStatus === taskStatus.ReviewPending)&&TaskModel?.TaskStatus !== ''">  
                        <a [routerLink]="" (click)="getLotsInfo(details)" >
                        <u>{{(details.CompletedQty)}}</u></a>
                      </td>                    
                      <td *ngIf="showToManager"  pTooltip="View Review Details" tooltipPosition="left">  
                        <a [routerLink]="" (click)="getLotsInfo(details)" ><u>{{(details.RevQty)}}</u></a>
                      </td>                                                         
                  </tr>
              </ng-template>
              <ng-template pTemplate="emptymessage" let-columns>
                <tr>
                    <td *ngIf="!showToManager" [attr.colspan]="6">
                      {{ globalResource.norecordsfound }}
                    </td>
                    <td *ngIf="showToManager" [attr.colspan]="7">
                      {{ globalResource.norecordsfound }}
                    </td>
                </tr>
              </ng-template>
          </p-table>
        </div>

        <!-- Product type lot completion and review details -->

        <p-dialog header="Lot Details" [(visible)]="showProductTypeLotDetailsModal" modal="modal" [resizable]="true" [responsive]="true" [width]="750" [minWidth]="200" >
            <div class="ui-g">                
                <div class="ui-g-12 ui-md-4">
                    <div class="paddingRL">
                        <label>
                          <strong>{{globalResource.strain  }}: </strong>
                        </label>
                        <label>
                            {{LotDetails?.StrainName}}
                        </label>
                      </div>
                </div>
                <div class="ui-g-12 ui-md-4">
                    <div class="paddingRL">
                        <label>
                          <strong>{{ globalResource.pkgtype  }}: </strong>
                        </label>
                        <label>
                            {{LotDetails?.PkgTypeName}}
                        </label>
                      </div>
                </div>
                <div class="ui-g-12 ui-md-4">
                    <div class="paddingRL">
                        <label>
                          <strong>{{ globalResource.pkgsize  }}: </strong>
                        </label>
                        <label>
                            {{LotDetails?.UnitValue}}{{globalResource.listgramunit}}
                        </label>
                      </div>
                </div><div class="ui-g-12 ui-md-4">
                    <div class="paddingRL">
                        <label>
                          <strong>{{ globalResource.itemqty  }}: </strong>
                        </label>
                        <label>
                            {{LotDetails?.ItemQty}}
                        </label>
                      </div>
                </div>
                <div class="ui-g-12 ui-md-4">
                    <div class="paddingRL">
                        <label>
                          <strong>{{ globalResource.assignqty  }}: </strong>
                        </label>
                        <label>
                            {{LotDetails?.AssignedQty}}  
                        </label>
                      </div>
                </div>
            </div>
            <div class="ui-grid ui-grid-responsive ui-grid-pad ui-fluid" style="margin: 10px 0px">
               
                <p-table [value]="productTypeLotDetails"
                  *ngIf="productTypeLotDetails?.length">
                    <ng-template pTemplate="caption">
                        <h6><strong>{{globalResource.pkgdetails}}</strong></h6>
                    </ng-template>
                    <ng-template pTemplate="header">
                        <tr>
                            <th style="width:10%;"> {{ globalResource.srno }} </th>                                                       
                            <!-- <th style="width:20%">{{globalResource.strain}}</th> -->
                            <th style="width:205px;">{{globalResource.lotno}}</th>
                            <th style="width:20%">{{globalResource.completedqty}}</th>                               
                            <th style="width:20%" *ngIf="showToManager">{{globalResource.revqty}}</th>                            
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-LotDetails let-i="rowIndex">
                        <tr>
                            <td> {{ i + 1 }} </td>                                                         
                            <!-- <td>{{LotDetails?.LotStrainName}}</td> -->
                            <td style="width:205px;">
                              <span>{{LotDetails?.GrowerLotNo}}</span>
                              <app-lot-comment
                                [LotId]="LotDetails?.LotId"
                                [LotCommentsCount]="LotDetails?.LotNoteCount"
                                (CommentIconClicked)="commentIconClicked($event)"
                              ></app-lot-comment>
                              <app-lot-note-icon
                                [LotId]="LotDetails?.LotId"
                                (NoteIconClicked)="showLotNote($event)"
                              ></app-lot-note-icon>
                            </td>     
                            <td>{{LotDetails?.ProcessedQty}}</td>                      
                            <td *ngIf="showToManager">{{LotDetails?.RevProcessedQty}}</td>                      
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="emptymessage" let-columns>
                        <tr>
                            <td [attr.colspan]="4">
                                {{ globalResource.norecordsfound }}
                            </td>
                        </tr>
                    </ng-template>
                </p-table>    
                
                <p-table [value]="productTypeMixPkgsDetails.PkgDetails" 
                  *ngIf="productTypeMixPkgsDetails.PkgDetails?.length" 
                  id="productTypeMixLotDetails" 
                  name="productTypeMixLotDetails">
                    <ng-template pTemplate="caption">
                            <h6><strong>{{globalResource.mixpkgdetails}}</strong></h6>
                    </ng-template>
                    <ng-template pTemplate="header">
                        <tr>
                          <th style="width:10%;">{{ globalResource.srno }} </th>    
                          <!-- <th style="width:20%;"> {{globalResource.pkgcode }} </th> -->
                          <th style="width:20%;">{{globalResource.completedqty}}</th>                                    
                          <th style="width:70%;">{{ globalResource.lotdetails }}</th>                              
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-pkgDetails let-k="rowIndex">
                        <tr>                          
                          <td style="width:10%;">
                            <label> {{ (k + 1) }}</label>
                          </td>
                          <!-- <td style="width:20%;">
                              <span> {{ pkgDetails?.PackageCode }}</span>
                          </td> -->
                          <td style="width:20%;">
                            <label> 1 </label>
                          </td>   
                          <td style="width:70%;">
                              <p-table [value]="getPkgMixLotDetails(pkgDetails.MixPkgId)">
                                  <ng-template pTemplate="header">
                                      <tr>
                                          <!-- <th>{{globalResource.strain}}</th> -->
                                          <th>{{globalResource.lotno}}</th>
                                          <th>{{globalResource.selectedjointsqty}}</th>
                                      </tr>
                                  </ng-template>
                                  <ng-template pTemplate="body" let-mixLotDetails>
                                      <tr>

                                          <!-- <td>{{mixLotDetails?.StrainName}} </td> -->
                                          <td>
                                              {{mixLotDetails?.GrowerLotNo}}
                                              <app-lot-comment
                                                [LotId]="mixLotDetails?.LotId"
                                                [LotCommentsCount]="mixLotDetails?.LotNoteCount"
                                                (CommentIconClicked)="commentIconClicked($event)"
                                              ></app-lot-comment>
                                              <app-lot-note-icon
                                              [LotId]="mixLotDetails?.LotId"
                                              (NoteIconClicked)="showLotNote($event)"
                                            ></app-lot-note-icon>
                                          </td>
                                          <td>{{mixLotDetails?.LotItemQty}}</td>
                                      </tr>
                                  </ng-template>
                                  <ng-template pTemplate="emptymessage">
                                      <tr>
                                          <td [attr.colspan]="2">
                                              {{globalResource.nolotselected}}
                                          </td>
                                      </tr>
                                  </ng-template>
                              </p-table>
                          </td>                                                                     
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="emptymessage">
                        <tr>
                            <td [attr.colspan]="4">
                                {{ globalResource.norecordsfound }}
                            </td>
                        </tr>
                    </ng-template>
                </p-table>  
              </div>
              <p-footer>            
                      <button type="button" pButton icon="fa-close" (click)="showProductTypeLotDetailsModal=false" label="Cancel"></button>
                      <div class="clear"></div>
                  </p-footer>
                  <div class="clear"></div>
          </p-dialog>

        <!-- End Product type lot completion and review details -->
        <div class="ui-g-12" >
            <h5>Lots For Strain</h5>
            <p-table [value]="uniqueBrandStrain">
                <ng-template pTemplate="header">
                    <tr>
                        <!-- <th style="width:20%">Brand</th> -->
                        <th style="width:20%">Strain</th>
                        <!-- <th style="width:20%">Lot Ids</th> -->
                        <th style="width:80%">Lot Details</th>
                        <!-- <th style="width:20%">Selected Weight</th> -->
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-orderDetail let-rowIndex="rowIndex">
                    <tr>
                        <!-- <td>{{orderDetail?.BrandName}}</td> -->
                        <td>{{orderDetail?.StrainName}}</td>
                        <!-- <td> <a [routerLink]="" (click)="openLotSelection(orderDetail?.BrandId, orderDetail?.StrainId, rowIndex)" >Select Lots</a> </td> -->
                        <td>
                            <p-table [value]="displayLotDetails(orderDetail)">
                                <ng-template pTemplate="header">
                                    <tr>
                                        <th>{{globalResource.strain}}</th>
                                        <th>{{globalResource.lotno}}</th>
                                        <th>{{globalResource.pkgsize}}</th>
                                        <th>{{globalResource.assignedjointsqty}}</th>
                                    </tr>
                                </ng-template>
                                <ng-template pTemplate="body" let-lotDetails >
                                    <tr>
                                        <td>{{lotDetails.StrainName}} </td>  
                                        <td>{{lotDetails.GrowerLotNo}}

                                            <app-lot-comment
                                                [LotId]="lotDetails?.LotId"
                                                [LotCommentsCount]="lotDetails?.LotNoteCount"
                                                (CommentIconClicked)="commentIconClicked($event)"
                                            ></app-lot-comment>

                                            <app-lot-note-icon
                                              [LotId]="lotDetails?.LotId"                                              
                                              (NoteIconClicked)="showLotNote($event)"
                                            ></app-lot-note-icon>
                                            
                                        </td>
                                        <td>{{lotDetails.UnitValue}} {{globalResource.listgramunit}}</td>  
                                        <td>{{lotDetails.AssignedJointsQty}} </td>                                          
                                    </tr>
                                </ng-template>
                                <ng-template pTemplate="emptymessage" let-columns>
                                  <tr>
                                      <td [attr.colspan]="2">
                                        {{ globalResource.norecordsfound }}
                                      </td>
                                  </tr>
                                </ng-template>
                            </p-table>                                
                        </td>
                    </tr>
                </ng-template>
                <ng-template pTemplate="emptymessage" let-columns>
                  <tr>
                      <td [attr.colspan]="2">
                        {{ globalResource.norecordsfound }}
                      </td>
                  </tr>
                </ng-template>
            </p-table>
        </div>

        <!-- completion parameter -->  
     <div 
     *ngIf="TaskModel?.TaskStatus == taskStatus.ReviewPending||TaskModel?.TaskStatus == taskStatus.Completed"
     class="ui-grid ui-grid-responsive ui-grid-pad ui-fluid" 
     style="margin: 10px 0px; width:100%;">
           <div class="ui-grid-row">
             <div class="ui-grid-col-4">
 
             </div>
             <div class="ui-grid-col-4">
                 <strong>Task Owner</strong>
             </div>
             <div class="ui-grid-col-4" *ngIf="showToManager">
               <strong>Reviewer</strong>
             </div>
           </div>
 
          <!-- Emp Act Hrs -->
          <div class="ui-grid-row">
              <div class="ui-grid-col-4">
                  <strong>{{ globalResource.actualhrs }} :</strong>
              </div>
              <div class="ui-grid-col-4">
                  {{ TaskModel?.ActHrs | minutesToTime }}
              </div>
              <div class="ui-grid-col-4" *ngIf="showToManager">                
                  {{ taskReviewModel?.racthrs | minutesToTime }}
              </div> 
          </div>
          <!-- End Act Hrs -->

   </div>             
 <!--End completion parameter -->
  </div>

  <p-dialog 
    header="Task Completion" 
    [(visible)]="PageFlag.showmodal" 
    modal="modal" 
    [resizable]="true" 
    [responsive]="true" 
    [width]="750"
     [minWidth]="200"
  >
    <form [formGroup]="completionForm" (ngSubmit)="submitCompleteParameter(completionForm.value)" formSubmit>        
      <div formArrayName="completeParamArr">
        <div class="ui-grid-row" *ngFor="let comp of completeParamArr?.controls; let i=index">                         
            <p-panel
              [toggleable]="true" 
              [style]="{'margin-bottom':'20px','width': '100%'}"
              [formGroupName]="i"
              [expandIcon]="'fa fa-chevron-left'"
              [collapseIcon]="'fa fa-chevron-down'"
            >
            <p-header class="accordionHeader">  
              <div class="ui-helper-clearfix"  >
                <p class="panel-titleCompletion">
                  <span class="ui-panel-title" style="font-size:16px;display:inline-block;margin-top:2px">
                      <!-- <span pTooltip="Brand Name">{{ TaskModel.AssignQtyDetails[i].BrandName }}</span>: <span pTooltip="Sub-Brand">{{ TaskModel.AssignQtyDetails[i].SubBrandName }}</span> -->
                      <span pTooltip="Strain Name">{{ TaskModel.AssignQtyDetails[i].StrainName }}</span>
                      : <span pTooltip="Pkg Type Name">{{ TaskModel.AssignQtyDetails[i].PkgTypeName }}</span>: <span pTooltip="Package Size">{{ TaskModel.AssignQtyDetails[i].UnitValue }}{{globalResource.listgramunit}}</span>
                      : <span pTooltip="Item Qty">{{ TaskModel.AssignQtyDetails[i].ItemQty }}</span>                         
                  </span>

                  <span class="ui-panel-title" style="font-size:16px;display:inline-block;margin-top:2px">                    
                    Assign Qty:{{ TaskModel.AssignQtyDetails[i].AssignedQty }} 
                </span>
              </p>                 
              <div style="display: inline-block;vertical-align: top;">
                <input                    
                  type="number"
                  pKeyFilter="pint" 
                  pTooltip="Completed Qty"            
                  pInputText
                  autocomplete="off"
                  [(ngModel)]="disableCompletedQtyArr[i]"
                  (change)="compQtyOnChange(i, comp)"                 
                  placeholder="Completed Qty"
                  formControlName="completedQty"                                            
                  id="completedqty"
                  name="completedqty"   
                  class="reviewedQty"
                />

                <div class="ui-message ui-messages-error ui-corner-all" appErrorTooltip
                      *ngIf="!comp.controls['completedQty'].valid&&comp.controls['completedQty'].dirty">
                      <span *ngIf="comp.controls['completedQty'].hasError('pkgqtynotmatched')">
                          {{ assignTaskResources.pkgqtynotmatched }}
                      </span>
                      <span *ngIf="comp.controls['completedQty'].hasError('max')">
                          {{ assignTaskResources.compqtygreaterassignqty }}
                      </span>
                </div>
              </div>
              </div>
            </p-header>
            
           <div formArrayName="LotDetails" class="panel-content" >
            <table class="table table-bordered">
              <thead>
                <tr>
                  <th>{{ globalResource.lotno }}</th>
                  <th>{{ globalResource.assignedjointsqty }}</th>
                  <th>{{ globalResource.tubecompleted }}</th>
                  <th>{{ globalResource.completedjointsqty }}</th>
                  <th>{{ globalResource.balancedjointsqty }}</th>
                </tr>
              </thead>                 
              <tbody>
            <tr *ngFor="let lot of lotInnerFormArray(comp).controls; let j=index;" [formGroupName]="j">                                                  
              <td  pTooltip="Grower Lot No." style="width:205px;">                                                      
                <label>
                    {{ lot.value.GrowerLotNo }}

                    <app-lot-comment
                        [LotId]="lot.value.LotId"
                        [LotCommentsCount]="lot.value.LotNoteCount"
                        (CommentIconClicked)="commentIconClicked($event)"
                    ></app-lot-comment>

                    <app-lot-note-icon
                      [LotId]="lot.value.LotId"                            
                      (NoteIconClicked)="showLotNote($event)"
                    ></app-lot-note-icon>
                </label>
              </td>
              <td pTooltip="Assigned Qty" >    
                <label>{{ lot.value.AssignedJointsQty }}</label>
              </td>
                <td>    
                <input  
                  pInputText
                  autocomplete="off"                 
                  type="number"
                  pKeyFilter="int"
                  (change)="calculateTotalCompletedQty(i, comp, lot)"
                  maxlength="AppConstants.maxLength"
                  placeholder="Packages Completed"
                  formControlName="lotCompletedQty"                                            
                  id="{{ 'lotCompletedQty' + j }}"
                  name="lotCompletedQty"                      
                />                     
            
              </td>   
              <td pTooltip="Completed Qty" >    
                  <label>{{ lotMap.get(lot.value.LotId + '' + comp.value.UnitValue ) || 0 }}</label>
              </td>
              <td pTooltip="Balanced Qty" >    
                  <label>{{ lotBalancedQtyMap.get(lot.value.LotId + '' + comp.value.UnitValue) || 0 }}</label>
              </td>       
            </tr>
          </table> 
          </div>
       
          <!-- Lot Mixing -->
          <div class="divLotMixing panel-content" formArrayName="MixLotDetails" *ngIf="comp.value.completedQty > 0 && lotInnerFormArray(comp).controls.length > 1">
            <strong><span class="ui-dialog-title">{{ assignTaskResources.mixlotdetails }}</span></strong>
            <hr>

            <table class="table table-bordered">
                <thead>
                  <tr>
                      <th>{{ globalResource.no }} </th>
                      <th>{{ globalResource.pkg }} </th>                                        
                      <th>{{ globalResource.lotdetails }}</th> 
                      <th></th>
                  </tr>
                </thead>                 
                <tbody>
                  <tr *ngFor="let mixLot of mixLotDetailsArr(comp).controls; let k=index;" [formGroupName]="k">                                                                    
                      <td style="width:5%;">                                                      
                        <label>
                            {{ k + 1 }}                                         
                        </label>
                      </td>
                      <td style="width:30%;">    
                        <label>{{ globalResource.pkg }} {{ (k + 1) | number:'2.0-0' }}</label>
                      </td>
                      <td style="width:60%;">  
                        <!-- Selected Mix Lot Details -->
                          <!-- <h6 class="first">{{assignTaskResources.mixlotdetails}}:</h6> -->
                          <p-table [value]="selectedMixLotsArray[i +''+ k]">
                              <ng-template pTemplate="header">
                                  <tr>
                                      <th>{{globalResource.lotno}}</th>
                                      <th>{{globalResource.selectedjointsqty}}</th>
                                  </tr>
                              </ng-template>
                              <ng-template pTemplate="body" let-lotDetails>
                                  <tr>
                                      <td>
                                          {{lotDetails?.GrowerLotNo}}
                                          <app-lot-comment
                                            [LotId]="lotDetails?.LotId"
                                            [LotCommentsCount]="lotDetails?.LotNoteCount"
                                            (CommentIconClicked)="commentIconClicked($event)"
                                            ></app-lot-comment>
                                          <app-lot-note-icon
                                          [LotId]="lotDetails?.LotNo"
                                          (NoteIconClicked)="showLotNote($event)"
                                        ></app-lot-note-icon>
                                      </td>
                                      <td>{{lotDetails?.SelectedJointsQty}}</td>
                                  </tr>
                              </ng-template>
                              <ng-template pTemplate="emptymessage">
                                  <tr>
                                      <td [attr.colspan]="2">
                                          {{globalResource.nolotselected}}
                                      </td>
                                  </tr>
                              </ng-template>
                          </p-table>
                          <!-- End of Selected Mix Lot Details -->
                          <span>
                              <a class="btn-link" [routerLink]="" (click)="openMixLotSelection(mixLot, k, i)" >Select Lots</a>
                          </span>  
                      </td>  
                      <td style="width:5%;">    
                          <a (click)="deleteItem(comp, i, k)" >                                  
                              <span class="fa fa-minus-circle">
                              </span>
                          </a>          
                      </td>   
                  </tr>
                </tbody>
            </table> 
            <a class="addbtn" [routerLink]="" (click)="addItem(comp,mixLot)">
                <span class="fa fa-plus-circle">
                </span>
            </a>
        </div>
        <!-- End Of Lot Mixing -->
        </p-panel>
      </div>

          <!-- <pre>{{completionForm.value | json}}</pre> -->
        </div>
          
        <div class="ui-grid ui-grid-responsive ui-grid-pad ui-fluid" style="margin: 10px 0px">
              <!-- <div class="ui-grid-row">
                    
                  <div class="ui-grid-col-4 text-right">
                    {{ assignTaskResources.misccost }} :
                  </div>
                  <div class="ui-grid-col-5">
                      <input type="text"
                        OnlyNumber="true" 
                        pInputText                               
                        formControlName="MiscCost"
                        id="misccost"
                        name="misccost"      
                      />               
                  </div> 
                 
              </div> -->
  
              <div class="ui-grid-row">
                 
                  <div class="ui-grid-col-4 text-right">
                    {{ assignTaskResources.comment }}:
                  </div>
                  <div class="ui-grid-col-5">
                      <textarea                        
                        pInputTextarea                 
                        formControlName="MiscComment"
                        id="misccomment"
                        name="misccomment"
                        maxlength="500"
                        class="clsControl"                  
                      ></textarea>
                  </div> 
                 
              </div>
          </div>
      <p-footer>
          <!-- [disabled]="!completionForm.valid" -->
        <button type="submit" pButton icon="fa-check"  label="Confirm"></button>
        <!-- [disabled]="!completionForm.valid" -->
        <button type="button" class="ui-button-secondary" pButton icon="fa-close" (click)="PageFlag.showmodal=false" label="Cancel"></button>
      </p-footer>
  </form>
</p-dialog>

<!-- Task Review Model -->
<p-dialog header="Submit Review" [(visible)]="PageFlag.showReviewmodal" modal="modal" [resizable]="true" [responsive]="true" [width]="750" [minWidth]="200" >
  <form [formGroup]="reviewForm" (ngSubmit)="submitReviewParameter(reviewForm.value)" formSubmit>

    <div formArrayName="reviewParamArr">
      <div class="ui-grid-row" *ngFor="let comp of reviewParamArr?.controls; let i=index">                         
          <p-panel
            [toggleable]="true" 
            [style]="{'margin-bottom':'20px','width': '100%'}"
            [formGroupName]="i"
          >
          <p-header class="accordionHeader">  
            <div class="ui-helper-clearfix" >
              <p class="panel-title">
                <span class="ui-panel-title" style="font-size:16px;display:inline-block;margin-top:2px">
                    <!-- <span pTooltip="Brand Name">{{ TaskModel.AssignQtyDetails[i].BrandName }}</span> 
                    : <span pTooltip="Sub-Brand">{{ TaskModel.AssignQtyDetails[i].SubBrandName }}</span>  -->
                    <span pTooltip="Strain Name">{{ TaskModel.AssignQtyDetails[i].StrainName }}</span> 
                    : <span pTooltip="Pkg Type Name">{{ TaskModel.AssignQtyDetails[i].PkgTypeName }}</span> 
                    : <span pTooltip="Package Size">{{ TaskModel.AssignQtyDetails[i].UnitValue }} {{globalResource.listgramunit}}</span> 
                    : <span pTooltip="Item Qty">{{ TaskModel.AssignQtyDetails[i].ItemQty }}</span>                        
                </span>

                <span class="ui-panel-title" style="font-size:16px;display:inline-block;margin-top:2px">                    
                  Completed Qty:{{ TaskModel.AssignQtyDetails[i].CompletedQty }} 
                </span>
              </p>
                <input                    
                  type="number"
                  pKeyFilter="int" 
                  pInputText
                  autocomplete="off"
                  [ngModel]="disableCompletedQtyArr[i]"
                  placeholder="Reviewed Qty"
                  formControlName="reviewedQty"                                            
                  id="reviewedqty"
                  name="reviewedqty"   
                  class="reviewedQty"

                />
            </div>
          </p-header>
          
          <div formArrayName="LotDetails" class="panel-content" >
            <table class="table table-bordered">
              <thead>
                <tr>
                  <th>{{ globalResource.lotno }}</th>
                  <th>{{ globalResource.assignedjointsqty }}</th>
                  <th>{{ globalResource.tubecompleted }}</th>
                  <th>{{ globalResource.completedjointsqty }}</th>
                  <th>{{ globalResource.balancedjointsqty }}</th>
                </tr>
              </thead>                 
              <tbody>             
            <tr *ngFor="let lot of lotInnerFormArray(comp).controls; let j=index;" [formGroupName]="j">                                                  
              <td  pTooltip="Grower Lot No." style="width:205px;">                                                      
                <label>
                    {{ lot.value.GrowerLotNo }}

                    <app-lot-comment
                        [LotId]="lot.value.LotId"
                        [LotCommentsCount]="lot.value.LotNoteCount"
                        (CommentIconClicked)="commentIconClicked($event)"
                    ></app-lot-comment>

                    <app-lot-note-icon
                      [LotId]="lot.value.LotId"                            
                      (NoteIconClicked)="showLotNote($event)"
                    ></app-lot-note-icon>

                </label>
              </td>
              <td pTooltip="Assigned Qty" >    
                <label>{{ lot.value.AssignedJointsQty }}</label>
              </td>
                <td>    
                <input  
                  pInputText
                  autocomplete="off"                 
                  type="number"
                  pKeyFilter="int"
                  (change)="calculateTotalReviewedQty(i, comp, lot)"
                  maxlength="AppConstants.maxLength"
                  placeholder="Packages Completed"
                  formControlName="lotReviewedQty"                                            
                  id="{{ 'lotCompletedQty' + j }}"
                  name="lotCompletedQty"                      
                />                     
            
              </td>   
              <td pTooltip="Completed Qty" >    
                  <label>{{ lotMap.get(lot.value.LotId + '' + comp.value.UnitValue) || 0 }}</label>
              </td>
              <td pTooltip="Balanced Qty" >    
                  <label>{{ lotBalancedQtyMap.get(lot.value.LotId + '' + comp.value.UnitValue) || 0 }}</label>
              </td>       
            </tr>
          </table> 
          </div>
     
          <!-- Lot Mixing -->
          <div class="divLotMixing panel-content" formArrayName="MixLotDetails" *ngIf="comp.value.reviewedQty > 0 && lotInnerFormArray(comp).controls.length > 1">
            <strong><span class="ui-dialog-title">{{ assignTaskResources.mixlotdetails }}</span></strong>
            <hr>

            <table class="table table-bordered">
                <thead>
                  <tr>
                      <th>{{ globalResource.no }} </th>
                      <th>{{ globalResource.pkg }} </th>                                        
                      <th>{{ globalResource.lotdetails }}</th> 
                      <!-- <th></th> -->
                  </tr>
                </thead>                 
                <tbody>
                  <tr *ngFor="let mixLot of mixLotDetailsArr(comp).controls; let k=index;" [formGroupName]="k">                                                                    
                      <td style="width:5%;">                                                      
                        <label>
                            {{ k + 1 }}                                         
                        </label>
                      </td>
                      <td style="width:30%;">    
                        <label>{{ globalResource.pkg }} {{ (k + 1) | number:'2.0-0' }}</label>
                      </td>
                      <td style="width:60%;">  
                        <!-- Selected Mix Lot Details -->
                          <!-- <h6 class="first">{{assignTaskResources.mixlotdetails}}:</h6> -->
                          <p-table [value]="selectedMixLotsArray[i +''+ k]">
                              <ng-template pTemplate="header">
                                  <tr>
                                      <th>{{globalResource.lotno}}</th>
                                      <th>{{globalResource.selectedjointsqty}}</th>
                                  </tr>
                              </ng-template>
                              <ng-template pTemplate="body" let-lotDetails>
                                  <tr>
                                      <td>
                                          {{lotDetails?.GrowerLotNo}}
                                          <app-lot-comment
                                            [LotId]="lotDetails?.LotId"
                                            [LotCommentsCount]="lotDetails?.LotNoteCount"
                                            (CommentIconClicked)="commentIconClicked($event)"
                                          ></app-lot-comment>
                                          <app-lot-note-icon
                                          [LotId]="lotDetails?.LotNo"
                                          (NoteIconClicked)="showLotNote($event)"
                                        ></app-lot-note-icon>
                                      </td>
                                      <td>{{lotDetails?.SelectedJointsQty}}</td>
                                  </tr>
                              </ng-template>
                              <ng-template pTemplate="emptymessage">
                                  <tr>
                                      <td [attr.colspan]="2">
                                          {{globalResource.nolotselected}}
                                      </td>
                                  </tr>
                              </ng-template>
                          </p-table>
                          <!-- End of Selected Mix Lot Details -->
                          <!-- <span>
                              <a class="btn-link" [routerLink]="" (click)="openMixLotSelection(mixLot, k, i)" >Select Lots</a>
                          </span>   -->
                      </td>  
                      <!-- <td style="width:5%;">    
                          <a (click)="deleteItem(comp, i, k)" >                                  
                              <span class="fa fa-minus-circle">
                              </span>
                          </a>          
                      </td>    -->
                  </tr>
                </tbody>
            </table> 
            <!-- <a class="addbtn" [routerLink]="" (click)="addItem(comp,mixLot)">
                <span class="fa fa-plus-circle">
                </span>
            </a> -->
        </div>
        <!-- End Of Lot Mixing -->
      </p-panel>
      </div>

        <!-- <pre>{{completionForm.value | json}}</pre> -->
      </div>
      <div class="ui-grid ui-grid-responsive ui-grid-pad ui-fluid" style="margin: 10px 0px">
          <div class="ui-grid-row">
             
            <div class="ui-grid-col-3 text-right">
              {{ assignTaskResources.actualhrs }}:
            </div>
            <div class="ui-grid-col-4">
                {{ TaskModel?.ActHrs | minutesToTime }}
            </div>
            <div class="ui-grid-col-5">
                 <!-- <p-calendar 
                  required 
                  name="acthrs"
                  [stepHour]="1" 
                  [stepMinute]="15" 
                  [timeOnly]="true" 
                  [showTime]="true" 
                  formControlName="ActHrs"
                  hourFormat="24">
                </p-calendar> -->

                <div class="ui-inputgroup ui-inputgroup-border" >
                    <input type="number"                   
                        pInputText 
                        autocomplete="off"
                        [(ngModel)]="taskReviewModel.racthrs"                         
                        formControlName="ActHrs"
                        id="acthrs"
                        pKeyFilter="int"
                        name="acthrs"    
                        style="width:80px;"                  
                      /> 
                      <span>:</span>
                      <input type="number"                  
                        pInputText       
                        autocomplete="off"            
                        [(ngModel)]="taskReviewModel.ractmins"                         
                        formControlName="ActMins"
                        id="actmins"
                        pKeyFilter="int"
                        name="actmins"   
                        style="width:80px;"                    
                      /> 
                      <!-- Added by Devdan :: Sec to Min change :: 06-Nov-2018 -->
                        <div class="ui-message ui-messages-error ui-corner-all" appErrorTooltip
                        *ngIf="!reviewForm.controls['ActMins'].valid&&reviewForm.controls['ActMins'].dirty">
                            <span *ngIf="reviewForm.controls['ActMins'].errors['max']">
                            {{ globalResource.maxMinSecValue }}
                            </span>
                        </div>
                        <!-- ADDED BY DEVDAN :: 06-NOV-2018 :: ADDING TEXTBOX FOR SECONDS -->
                        <span>:</span>
                        <input type="number"                  
                        pInputText         
                        autocomplete="off"      
                        pKeyFilter="int"    
                        [(ngModel)]="taskReviewModel.ractsecs"                         
                        formControlName="ActSecs"
                        id="actsecs"
                        name="actsecs"                  
                        style="width:80px;"
                        />
                        <div class="ui-message ui-messages-error-Sec ui-corner-all" appErrorTooltip
                        *ngIf="!reviewForm.controls['ActSecs'].valid&&reviewForm.controls['ActSecs'].dirty">
                            <span *ngIf="reviewForm.controls['ActSecs'].errors['max']">
                            {{ globalResource.maxMinSecValue }}
                            </span>
                        </div>
                        <!-- END :: Sec to Min change :: 06-Nov-2018 -->
                  </div>
            </div> 
           
        </div>
          <div class="ui-grid-row">
               
              <div class="ui-grid-col-3 text-right">
                {{ assignTaskResources.misccost }}:
              </div>
              <div class="ui-grid-col-4">
                  {{ TaskModel?.MiscCost  | currency }}
              </div>
              <div class="ui-grid-col-5">
                  <input type="text"
                    OnlyNumber="true" 
                    pInputText 
                    pKeyFilter="num"     
                    autocomplete="off"                         
                    formControlName="MiscCost"
                    id="misccost"
                    name="misccost"      
                  />               
              </div> 
             
          </div>

          <div class="ui-grid-row">
             
              <div class="ui-grid-col-3 text-right">
                {{ assignTaskResources.comment }}:
              </div>
              <div class="ui-grid-col-4">
                 {{ TaskModel?.Comments }}
              </div>
              <div class="ui-grid-col-5">
                  <textarea                        
                    pInputTextarea                 
                    formControlName="MiscComment"
                    id="misccomment"
                    name="misccomment"
                    maxlength="500"
                    class="clsControl"                  
                  ></textarea>
              </div> 
             
          </div>
      </div>
    <p-footer>
        <!-- [disabled]="!completionForm.valid" -->
      <button type="submit" pButton icon="fa-check"  label="Confirm"  ></button>
      <!-- [disabled]="!reviewForm.valid" -->
      <button type="button" class="ui-button-secondary" pButton icon="fa-close" (click)="PageFlag.showReviewmodal=false" label="Cancel"></button>
    </p-footer>
</form>
</p-dialog>
<!-- End of Task Review Model -->

<!-- Select Mix Lot Pkg Details -->
<p-dialog header="Select Lots"
    [(visible)]="showMixLotSelectionModel"
    modal="modal"
    [resizable]="true"
    [responsive]="true" [width]="600" [minWidth]="300"  >

    <form [formGroup]="questionForm" (ngSubmit)="submitMixLotDetails(questionForm)" formSubmit >
          <!-- (ngSubmit)="submit(questionForm)" -->
    <div class="ui-grid ui-grid-responsive ui-grid-pad ui-fluid" style="margin: 10px 0px">

      <div class="ui-g">
              <div class="ui-g-12 ui-md-4">
                  <label>
                    <strong>{{globalResource.strain}}</strong>
                  </label>

                  <label>
                    {{ selMixLotPkgRow?.StrainName }}
                  </label>
                </div>

                <div class="ui-g-12 ui-md-4">
                    <label>
                      <strong>{{globalResource.requiredjointsqty}}</strong>
                    </label>

                    <label>
                      {{ selMixLotPkgRow?.RequireQty }}
                    </label>
                  </div>

        </div>
        <div formArrayName="questions">
          
        <p-table [value]="questions?.controls" id="tblMixLotSelection">
            <ng-template pTemplate="header">
                <tr>
                    <th style="width:230px">{{globalResource.lotno}}</th>
                    <th style="width:20.33333333%">{{globalResource.completedqty}}</th>
                    <th style="width:20.33333333%">{{globalResource.balancedqty}}</th>
                    <th style="width:20.33333333%">{{globalResource.selectedjointsqty}}</th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-question let-i="rowIndex" >
                <tr [formGroupName]="i">
                    <td style="width:230px">
                        <p-checkbox
                          label="{{ question?.value.GrowerLotNo  }}"
                          formControlName="question"
                          (ngModelChange)="changeValidator($event, i)"
                          binary="true"
                        ></p-checkbox>

                        <app-lot-comment
                            [LotId]="question?.value.LotId"
                            [LotCommentsCount]="question?.value.LotNoteCount"
                            (CommentIconClicked)="commentIconClicked($event)"
                        ></app-lot-comment>

                        <app-lot-note-icon
                          [LotId]="question?.value.LotNo"                                
                          (NoteIconClicked)="showLotNote($event)"
                        ></app-lot-note-icon>
                                                
                    </td>
                    <td pTooltip="Completed Qty" >    
                        <label>{{ lotMap.get(question?.value.LotNo + '' + question?.value.UnitValue) || 0 }}</label>
                    </td>
                    <td pTooltip="Balanced Qty" >    
                        <label>{{ lotBalancedQtyMap.get(question?.value.LotNo + '' + question?.value.UnitValue) || 0 }}</label>
                    </td> 
                    <td>
                      <input
                        type="number"
                        pKeyFilter="int"
                        pInputText
                        autocomplete="off"
                        formControlName="answer"
                        id="answer"
                        name="answer"
                        style="width:100%;"
                      />
                      <!-- (change)="CalculateMixLotWt(question, 'SPECIFIC')" -->
                    </td>
                </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage">
              <tr>
                  <td [attr.colspan]="3">
                    {{ assignTaskResources.nolotpresent }} "{{ selLotBrandStrainRow?.StrainName }}".
                  </td>
              </tr>
            </ng-template>
        </p-table>
        </div>              
      </div>
      <p-footer class="text-right">

        <button type="submit"  pButton icon="fa-check"  label="Confirm" id="btnMixLotSelectionConfirm" name="btnMixLotSelectionConfirm" ></button>
        <!-- [disabled]="questionForm.invalid" -->
        <button type="button" pButton icon="fa-close" (click)="showMixLotSelectionModel=false" label="Cancel"></button>
    </p-footer>
  </form>
</p-dialog>
<!-- End of Select Mix Lot Pkg Details -->
  </div>
  <p-growl [(value)]="msgs" life='5000' ></p-growl>