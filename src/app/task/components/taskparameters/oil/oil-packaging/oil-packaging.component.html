<div class="ui-g " [formGroup]="OILPACKAGING" *ngIf="PageFlag.page =='AssignTask'">
  <!--Order No-->
  <div class="ui-g-12 ui-md-6">
      <div class="paddingRL">
        <label for="orderno">{{ globalResource.orderno }}<span class="star">*</span></label>{{ globalResource.labelcolon }}

        <p-dropdown
        [filter] ="true"
          [options]="allOrderNos"
          [(ngModel)]="TaskModel.OILPACKAGING.orderno"
          defaultLabel="-- Select --"
          (onChange)="onOrderChange()"
          formControlName="orderno"
          class="clsControl"
          id="orderno"
          name="orderno"
          [readonly]="readiOnlyFlag"
        ></p-dropdown>

        <div
          class="ui-message ui-messages-error ui-corner-all" appErrorTooltip
          *ngIf="!OILPACKAGING.controls['orderno'].valid&&OILPACKAGING.controls['orderno'].dirty">
            <span *ngIf="OILPACKAGING.controls['orderno'].errors['required']">
              {{ globalResource.ordernorequired }}
            </span>
        </div>

      </div>
    </div>
    <!--End Order NO -->

    <!--Delivery Date-->
    <div class="ui-g-12 ui-md-6">
        <div class="paddingRL">
        <label for="deliverydate">{{ globalResource.deliverydate }}</label>{{ globalResource.labelcolon }}

        <span class="lblText">
            {{ orderObject?.DeliveryDate | date:'MM/dd/yyyy' }}
        </span>

      </div>
  </div>
  <!--End Delivery Date-->

    <!-- Order Details -->
    <div class="ui-g-12" *ngIf="TaskModel.OILPACKAGING.orderno" formArrayName="oilOrderPackets">
      <h5>Order Details</h5>
      <p-table [value]="oilOrderPackets?.controls">
          <ng-template pTemplate="header">
              <tr>
                  <th style="width:15%">{{globalResource.brand}}</th>
                  <th style="width:15%">{{globalResource.subbrand}}</th>
                  <th style="width:15%">{{globalResource.strain}}</th>
                  <th style="width:15%">{{globalResource.pkgtype}}</th>
                  <th style="width:15%">{{globalResource.pkgsize}}</th>
                  <!-- <th style="width:15%">{{globalResource.itemqty}}</th> -->
                  <th style="width:15%">{{globalResource.orderqty}}</th>
                  <th style="width:15%">{{globalResource.requirewt}}</th>
                  <th style="width:15%">{{globalResource.assignqty}}</th>
              </tr>
          </ng-template>
          <ng-template pTemplate="body" let-budOrderPacket let-i="rowIndex" >
              <tr [formGroupName]="i">
                  <td>{{orderDetails[i].BrandName}}</td>
                  <td>{{orderDetails[i].SubBrandName}}</td>
                  <td>{{orderDetails[i].StrainName}}</td>
                  <td>{{orderDetails[i].PkgTypeName}}</td>
                  <td>{{orderDetails[i].UnitValue}} {{globalResource.listgramunit}}</td>
                  <!-- <td>{{orderDetails[i].ItemQty}}</td> -->
                  <td>{{orderDetails[i].RequiredQty}}</td>
                  <td>{{(orderDetails[i].TotalWt)}}</td>
                  <td>
                    <input
                      type="number"                                               
                      pKeyFilter="pint"                     
                      pInputText
                      autocomplete="off"                        
                      formControlName="assignPackageWt"
                      id="answer"
                      name="answer"
                      style="width:100%;"
                    />
                    <!-- (change)="AssignWtOnChange(budOrderPacket)" -->
                  </td>
              </tr>
          </ng-template>
          <ng-template pTemplate="emptymessage" let-columns>
            <tr>
                <td [attr.colspan]="9">
                   {{ globalResource.norecordsfound }}
                </td>
            </tr>
          </ng-template>
      </p-table>

      <!-- <div class="text-right">
        <button type="submit" pButton icon="fa-check"  label="Confirm" ></button>
      </div> -->
    </div>
    <!--End Order Details -->

    <div class="ui-g-12" *ngIf="TaskModel.OILPACKAGING.orderno" >
        <h5>Select Packages For Order</h5>

        <p-table [value]="orderDetailsBS_filteredData">
            <ng-template pTemplate="header">
                <tr>
                    <!-- <th style="width:20%">{{globalResource.brand}}</th> -->
                    <th style="width:20%">{{globalResource.strain}}</th>
                    <!-- <th style="width:20%">Lot Ids</th> -->
                    <th style="width:80%">{{globalResource.pkgdetails}}</th>
                    <!-- <th style="width:20%">Selected Weight</th> -->
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-orderDetail let-rowIndex="rowIndex">
                <tr>
                    <!-- <td>{{orderDetail?.BrandName}}</td> -->
                    <td>{{orderDetail?.StrainName}}</td>
                    <!-- <td> <a [routerLink]="" (click)="openPkgSelection(orderDetail?.BrandId, orderDetail?.StrainId, rowIndex)" >Select Lots</a> </td> -->
                    <td>
                        <p-table [value]="selectedPkgsArray[rowIndex]">
                            <ng-template pTemplate="header">
                                <tr>
                                  <th style="width:20%">Oil Pkg. Code</th>
                                  <th style="width:20%">TP Pkg. Type</th>
                                  <th style="width:20%">Avail. Oil Wt.</th>
                                  <th style="width:20%">Selected Weight</th>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-pkgDetails >
                                <tr>
                                    <td>{{pkgDetails.OilPkgCode}}</td>
                                    <td>{{pkgDetails.TPPkgTypeName}}</td>
                                    <td>{{pkgDetails.AvailWt}} {{globalResource.listgramunit}}</td>
                                    <td>{{pkgDetails.SelectedWt}}</td>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="emptymessage" let-columns>
                              <tr>
                                  <td [attr.colspan]="4">
                                    {{ globalResource.norecordsfound }}
                                  </td>
                              </tr>
                            </ng-template>
                        </p-table>

                        <span  *ngIf="orderDetail.LotCount > 0" >
                        <a class="btn-link" [routerLink]="" (click)="openPkgSelection(orderDetail?.StrainId, orderDetail?.GeneticsId, rowIndex)" >Select Pkgs</a>
                      </span>
                      <span class="star"  *ngIf="orderDetail.LotCount === 0" >
                          {{ globalResource.oilpkgnotavailable }}  
                        </span>
                             
                      </td>
                </tr>
            </ng-template>
        </p-table>
    </div>

    <!--Employee-->
    <div class="ui-g-12 ui-md-6">
        <div class="paddingRL">
          <label for="employee">{{ globalResource.employee }}<span class="star">*</span></label>{{ globalResource.labelcolon }}

            <p-dropdown
            [filter] ="true"
              [options]="employees"
              [(ngModel)]="TaskModel.OILPACKAGING.employee"
              class="clsControl"
              formControlName="employee"
              id="employee"
              name="employee">
          </p-dropdown>

          <div
            class="ui-message ui-messages-error ui-corner-all" appErrorTooltip
            *ngIf="!OILPACKAGING.controls['employee'].valid&&OILPACKAGING.controls['employee'].dirty">
              <span *ngIf="OILPACKAGING.controls['employee'].errors['required']">
                {{ globalResource.employeerequired }}
              </span>
          </div>
        </div>
    </div>
    <!--End Employee-->

  <!--Estimated Start Date-->
  <div class="ui-g-12 ui-md-6">
      <div class="paddingRL">
        <label for="estimatedstartdatetime">
          {{ globalResource.eststartdate }}<span class="star">*</span>{{ globalResource.labelcolon }}
        </label>
        <small class="smallTextRed"
          *ngIf="showPastDateLabel"
          >({{ globalResource.pastdatetask }})
        </small>
          <p-calendar
            [(ngModel)]="TaskModel.OILPACKAGING.startdate"
            [showIcon]="true"
            [defaultDate]="defaultDate"
            (onSelect)="estStartDate_Select()"
            (onInput)="estStartDate_Select()"
            formControlName="estimatedstartdate"
            class="clsControl"
            id="estimatedstartdate"
            name="estimatedstartdate"
         >
       </p-calendar>
          <div
            class="ui-message ui-messages-error ui-corner-all" appErrorTooltip
            *ngIf="!OILPACKAGING.controls['estimatedstartdate'].valid&&OILPACKAGING.controls['estimatedstartdate'].dirty">
              <span *ngIf="OILPACKAGING.controls['estimatedstartdate'].errors['required']">
                {{ globalResource.startdaterequired }}
              </span>
          </div>

          <div class="ui-message ui-messages-error ui-corner-all" appErrorTooltip
            *ngIf="OILPACKAGING.hasError('invalidDate')" >
              {{ globalResource.datecomparevalidation }}
          </div>
      </div>
  </div>
  <!--End Estimated Start Date-->

   <!--Priority-->
   <div class="ui-g-12 ui-md-6">
      <div class="paddingRL">
      <label for="employee">{{ globalResource.priority }}</label>{{ globalResource.labelcolon }}

      <p-dropdown
        [options]="priorities"
        [(ngModel)]="TaskModel.OILPACKAGING.priority"
        [autoWidth]="true"
        formControlName="priority"
        id="priority"
        class="clsControl"
        name="priority">
      </p-dropdown>
    </div>
  </div>
  <!--End Priority-->

  <!--Notify Manager/Employee-->
  <div class="ui-g-12 ui-md-6">
      <div class="paddingRL">
          <label ></label>
        <div class="clear"></div>

          <p-checkbox
            value="chkManagerCheck"
            label="{{ assignTaskResources.notifymanager }}"
            [(ngModel)]="TaskModel.OILPACKAGING.notifymanager"
            formControlName="notifymanager"
            binary="true"
          ></p-checkbox>

          <p-checkbox
            value="chkEmployeeCheck"
            label="{{ assignTaskResources.notifyemployee }}"
            [(ngModel)]="TaskModel.OILPACKAGING.notifyemployee"
            formControlName="notifyemployee"
            binary="true"
          ></p-checkbox>
      </div>
  </div>
  <!--End Notify Manager/Employee-->
  <!--Comment-->
  <div class="ui-g-12 ui-md-6">
      <div class="paddingRL">
        <label for="comment">{{ assignTaskResources.comment }}</label>{{ globalResource.labelcolon }}

          <textarea
            pInputTextarea
            [(ngModel)]="TaskModel.OILPACKAGING.usercomment"
            formControlName="comment"
            id="comment"
            name="comment"
            class="clsControl"
            maxlength="500"
          ></textarea>

          <div
            class="ui-message ui-messages-error ui-corner-all" appErrorTooltip
            *ngIf="!OILPACKAGING.controls['comment'].valid&&OILPACKAGING.controls['comment'].dirty">
              <span *ngIf="OILPACKAGING.controls['comment'].errors['maxLength']">
                {{ assignTaskResources.commentMaxLength }}
              </span>
        </div>
      </div>
    </div>
    <!--End Comment-->
  
      <p-dialog header="Select Pkgs"
        [(visible)]="showPkgSelectionModel"
        modal="modal"
        [resizable]="true"
        [responsive]="true" [width]="600" [minWidth]="300" [blockScroll]="true" >

          <form [formGroup]="questionForm" (ngSubmit)="submit(questionForm)" formSubmit>
        <div class="ui-grid ui-grid-responsive ui-grid-pad ui-fluid" style="margin: 10px 0px">

          <div class="ui-g">
              <div class="ui-g-12 ui-md-6">
                  <label>
                      <strong>Genetics</strong>
                    </label>

                    <label> 
                      {{ selPkgBrandStrainRow?.GeneticsName }}
                    </label>
                </div>
                  <!-- <div class="ui-g-12 ui-md-6">
                      <label>
                        <strong>Strain</strong>
                      </label>

                      <label>
                        {{ selPkgBrandStrainRow?.StrainName }}
                      </label>
                    </div> -->

                    <div class="ui-g-12 ui-md-6">
                        <label>
                          <strong>Required Weight</strong>
                        </label>

                        <label>
                          {{ selPkgBrandStrainRow?.combinationTotalAssignedWt }} {{globalResource.measure}}
                        </label>
                      </div>

            </div>
            <div formArrayName="questions">
            <p-table [value]="questions?.controls">
                <ng-template pTemplate="header">
                    <tr>
                        <th style="width:20%">Strain</th>
                        <th style="width:20%">Oil Pkg Code</th>
                        <th style="width:20%">TP Pkg. Type</th>
                        <th style="width:20%">Avail. Oil Wt.</th>
                        <th style="width:20%">Selected Weight</th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-question let-i="rowIndex" >
                    <tr [formGroupName]="i">
                        <td> {{ brandStrainPkgs[i].StrainName  }}</td>
                        <td>
                            <p-checkbox
                              label="{{ brandStrainPkgs[i].OilPkgCode  }}"
                              formControlName="question"
                              (ngModelChange)="changeValidator($event, i)"
                              binary="true"
                            ></p-checkbox>                  
                        </td>
                        <td> {{ brandStrainPkgs[i].TPPkgTypeName  }}</td>
                        <!-- <td> {{ brandStrainPkgs[i].AvailableWt  }} {{globalResource.listgramunit}}</td> -->
                        <td> 
                          <ng-container *ngIf="taskId && taskId > 0">
                            {{ question.value.AvailWt  }} {{globalResource.listgramunit}}
                          </ng-container>
                          <ng-container *ngIf="!taskId">
                            {{ brandStrainPkgs[i].AvailableWt }} {{globalResource.listgramunit}}
                          </ng-container>
                        </td>
                        <td>
                          <input
                            type="number"
                            OnlyNumber="true"
                            pInputText
                            autocomplete="off"
                            formControlName="answer"
                            id="answer"
                            name="answer"
                            style="width:100%;"
                        />
                        <div
                          class="ui-message ui-messages-error ui-corner-all" appErrorTooltip
                          *ngIf="!question.controls['answer'].valid&&question.controls['answer'].dirty">
                            <span *ngIf="question.controls['answer'].errors['max'] || question.controls['answer'].errors['min']">
                              Select Valid Weight
                            </span>  
                            <span *ngIf="question.controls['answer'].errors['required']">
                              Required
                            </span>
                            <span *ngIf="question.controls['answer'].hasError('oilpkgmaxwtexceeded')">
                              max lot wt exceeded 
                            </span>
                        </div>
                      </td>
                    </tr>
                </ng-template>
                <ng-template pTemplate="emptymessage" let-columns>
                  <tr>
                      <td [attr.colspan]="4">
                          Sorry, No package is present against "{{ selPkgBrandStrainRow?.StrainName }}".
                      </td>
                  </tr>
                </ng-template>
            </p-table>
            </div>
            
          </div>
          <p-footer class="text-right">

            <button type="submit" pButton icon="fa-check"  label="Confirm" ></button>
            <!-- [disabled]="questionForm.invalid" -->
            <button type="button" pButton icon="fa-close" (click)="showPkgSelectionModel=false" label="Cancel"></button>
        </p-footer>
      </form>
      </p-dialog>
  </div>

  <div *ngIf="PageFlag.page =='TaskAction'">
    <div class="ui-g">
      <!--Employee -->
   <div class="ui-g-12 ui-md-6">
    <div class="paddingRL">
        <label>
          <strong>{{ globalResource.employee }}: </strong>
        </label>

        <label>
          {{TaskModel?.EmpName}}
        </label>
      </div>
    </div>
    <!--End Employee -->
    <!-- OrderRefId -->
    <div class="ui-g-12 ui-md-6">
      <div class="paddingRL">
        <label>
          <strong>Order Id: </strong>
        </label>

          {{TaskModel?.OrderRefId}}
      </div>
    </div>
    <!--End OrderRefId -->
    <!-- RetailerName -->
    <div class="ui-g-12 ui-md-6">
        <div class="paddingRL">
          <label>
            <strong>Retailer Name: </strong>
          </label>
  
            {{TaskModel?.RetailerName}}
        </div>
      </div>
      <!--End RetailerName -->
    <!--Brand-->
    <div class="ui-g-12 ui-md-6">
      <div class="paddingRL">
        <label>
          <strong>Delivery Date: </strong>
        </label>

          {{TaskModel?.DeliveryDate}}
      </div>
    </div>
    <!--End Brand-->

    <!--Estimated Start DateTime-->
    <div class="ui-g-12 ui-md-6">
      <div class="paddingRL">
          <label>
            <strong>{{ globalResource.eststartdate }}: </strong>
          </label>

            {{TaskModel?.EstStartDate }}
        </div>
      </div>
      <!--End Estimated Start DateTime-->

     <!--Actual Start DateTime-->
     <div class="ui-g-12 ui-md-6" *ngIf="TaskModel?.TaskStatus !== taskStatus.Assigned&&TaskModel?.TaskStatus !== ''" >
        <div class="paddingRL">
            <label>
              <strong>{{ globalResource.actualstartdate }}: </strong>
            </label>

              {{TaskModel?.ActStartDate }}
          </div>
        </div>
        <!--End Actual Start DateTime-->

      <!--Actual End DateTime-->
      <div class="ui-g-12 ui-md-6" *ngIf="TaskModel?.TaskStatus !== taskStatus.Assigned&&TaskModel?.TaskStatus !== ''">
        <div class="paddingRL">
          <label>
            <strong>{{ globalResource.actualenddate }}: </strong>
          </label>

            {{TaskModel?.ActEndDate}}
        </div>
      </div>
      <!--End Actual End DateTime-->

     <!--Actual cost-->
     <div class="ui-g-12 ui-md-6" *ngIf="(TaskModel?.TaskStatus === taskStatus.Completed||TaskModel?.TaskStatus === taskStatus.ReviewPending)&&TaskModel?.TaskStatus !== ''">
        <div class="paddingRL">
            <label>
              <strong>{{ assignTaskResources.actualcost }}: </strong>
            </label>
         
              {{TaskModel?.EmpFinalCost | currency }}
          </div>
        </div>
      <!--End Actual costs-->

    <!--Priority -->
    <div class="ui-g-12 ui-md-6">
      <div class="paddingRL">
          <label>
            <strong>{{ globalResource.priority }}: </strong>
          </label>

          {{TaskModel?.TaskPriority}}
        </div>
      </div>
      <!--End Priority -->

     <!--Misc. Cost-->
     <div class="ui-g-12 ui-md-6" *ngIf="TaskModel?.TaskStatus === taskStatus.Completed" >
        <div class="paddingRL">
            <label>
              <strong>{{ globalResource.misccost }}: </strong>
            </label>

              {{taskReviewModel?.rmisccost | currency }}
          </div>
        </div>
        <!--End Misc. Cost-->
        <div class="ui-g-12" >
          <h5>Order Details</h5>
          <p-table [value]="TaskModel?.AssignQtyDetails">
              <ng-template pTemplate="header">
                  <tr>
                      <th style="width:20%">{{globalResource.brand}}</th>
                      <th style="width:20%">{{globalResource.subbrand}}</th>
                      <th style="width:20%">{{globalResource.strain}}</th>
                      <th style="width:20%">{{globalResource.pkgtype}}</th>
                      <th style="width:20%">{{globalResource.pkgsize}}</th>
                      <!-- <th style="width:20%">{{globalResource.itemqty}}</th> -->
                      <!-- <th style="width:20%">Order Qty</th> -->
                      <th style="width:20%">{{globalResource.assignqty}}</th>
                      <th style="width:20%" *ngIf="(TaskModel?.TaskStatus === taskStatus.Completed||TaskModel?.TaskStatus === taskStatus.ReviewPending)&&TaskModel?.TaskStatus !== ''">
                        {{globalResource.completedqty}}
                      </th>
                      <th style="width:20%" *ngIf="showToManager">{{globalResource.revqty}}</th>
                  </tr>
              </ng-template>
              <ng-template pTemplate="body" let-details let-i="rowIndex" >
                  <tr >
                      <td>{{details.BrandName}}</td>
                      <td>{{details.SubBrandName}}</td>
                      <td>{{details.StrainName}}</td>
                      <td>{{details.PkgTypeName}}</td>
                      <td>{{details.UnitValue}} {{globalResource.listgramunit}}</td>
                      <!-- <td>{{details.ItemQty}}</td> -->
                      <td>{{details.AssignedQty}}</td>                                                
                      <td 
                        pTooltip="View Completion Details" tooltipPosition="left"
                        *ngIf="(TaskModel?.TaskStatus === taskStatus.Completed||TaskModel?.TaskStatus === taskStatus.ReviewPending)&&TaskModel?.TaskStatus !== ''">  
                        <a [routerLink]="" (click)="getPkgInfo(details?.ProductTypeId)" >
                        <u>{{(details.CompletedQty)}}</u></a>
                      </td>                    
                      <td *ngIf="showToManager" pTooltip="View Review Details" tooltipPosition="left">  
                        <a [routerLink]="" (click)="getPkgInfo(details?.ProductTypeId)" ><u>{{(details.RevQty)}}</u></a>
                      </td>                                                         
                  </tr>
              </ng-template>
              <ng-template pTemplate="emptymessage" let-columns>
                <tr>
                    <td [attr.colspan]="9">
                      {{ globalResource.norecordsfound }}
                    </td>
                </tr>
              </ng-template>
          </p-table>
        </div>

        <!-- Product type lot completion and review details -->

        <p-dialog header="Package Details" [(visible)]="showProductTypePkgDetailsModal" modal="modal" [resizable]="true" [responsive]="true" [width]="750" [minWidth]="200" >
          <div class="ui-grid ui-grid-responsive ui-grid-pad ui-fluid" style="margin: 10px 0px">
              <div class="ui-g">
                  <div class="paddingRL">
                          <!--Brand -->
                          <div class="ui-g-12 ui-md-4">                      
                              <label>
                                <strong>{{ globalResource.brand }}: </strong>
                              </label>
                      
                              <label>
                                {{packageDetails?.BrandName}}
                              </label>
                          </div>
                          <!--End Brand -->
    
                          <!--Sub Brand -->
                          <div class="ui-g-12 ui-md-4">                      
                              <label>
                                <strong>{{ globalResource.subbrand }}: </strong>
                              </label>
                      
                              <label>
                                {{packageDetails?.SubBrandName}}
                              </label>
                          </div>
                          <!--End Sub Brand -->
    
                          <!--strain -->
                          <div class="ui-g-12 ui-md-4">                      
                              <label>
                                <strong>{{ globalResource.strain }}: </strong>
                              </label>
                      
                              <label>
                                {{packageDetails?.StrainName}}
                              </label>
                          </div>
                          <!--End strain -->
    
                          <!-- pkgtype -->
                          <div class="ui-g-12 ui-md-4">                      
                              <label>
                                <strong>{{ globalResource.pkgtype }}: </strong>
                              </label>
                      
                              <label>
                                {{packageDetails?.PkgTypeName}}
                              </label>
                          </div>
                          <!--End pkgtype -->
    
                          <!--pkgsize -->
                          <div class="ui-g-12 ui-md-4">                      
                              <label>
                                <strong>{{ globalResource.pkgsize }}: </strong>
                              </label>
                      
                              <label>
                                {{packageDetails?.UnitValue}} {{globalResource.listgramunit}}
                              </label>
                          </div>
                          <!--End pkgsize -->
    
                           <!--itemqty -->
                           <div class="ui-g-12 ui-md-4">                      
                              <label>
                                <strong>{{ globalResource.assignedqty }}: </strong>
                              </label>
                      
                              <label>
                                {{packageDetails?.AssignedQty}}
                              </label>
                          </div>
                          </div>
              </div>
              <p-table [value]="productTypePkgDetails">
                  <ng-template pTemplate="caption">
                          <h6>Package Details</h6>
                  </ng-template>
                  <ng-template pTemplate="header">
                      <tr>                    
                          <th style="width:10%;"> {{ globalResource.srno }} </th>
                          <!-- <th> {{globalResource.pkgcode }} </th> -->
                          <th style="width:20%">{{globalResource.completedqty}}</th>                                                                                 
                          <th style="width:20%" *ngIf="showToManager">{{globalResource.revqty}}</th> 
                          <th style="width:20%">Owner {{globalResource.tppkgcode}}</th>    
                          <th style="width:20%" *ngIf="showToManager">Reviewer {{globalResource.tppkgcode}}</th>                            
                      </tr>
                  </ng-template>
                  <ng-template pTemplate="body" let-PkgDetails let-i="rowIndex">
                      <tr>                               
                          <td> {{ i + 1 }} </td>
                          <!-- <td>{{LotDetails?.PackageCode}}</td> -->
                          <td>{{PkgDetails?.ProcessedOilQty}}</td>                        
                          <td *ngIf="showToManager">{{PkgDetails?.RevProcessedOilQty}}</td>     
                        <td>{{PkgDetails?.OilPkgCode}}</td>                          
                        <td *ngIf="showToManager">{{PkgDetails?.RevOilPkgCode}}</td>                         
                      </tr>
                  </ng-template>
                  <ng-template pTemplate="emptymessage">
                      <tr>
                          <td [attr.colspan]="5">
                              {{ globalResource.norecordsfound }}
                          </td>
                      </tr>
                  </ng-template>
              </p-table>               
            </div>
            <p-footer>            
                    <button type="button" pButton icon="fa-close" (click)="showProductTypePkgDetailsModal=false" label="Cancel"></button>
                    <div class="clear"></div>
                </p-footer>
                <div class="clear"></div>
        </p-dialog>

        <!-- End Product type lot completion and review details -->
        <div class="ui-g-12" >
            <h5>Pkgs For Order</h5>            
            <p-table [value]="uniqueBrandStrain">
              <ng-template pTemplate="header">
                  <tr>                      
                      <th style="width:20%">{{globalResource.strain}}</th>                      
                      <th style="width:80%">{{globalResource.pkgdetails}}</th>                      
                  </tr>
              </ng-template>
              <ng-template pTemplate="body" let-orderDetail let-rowIndex="rowIndex">
                  <tr>                      
                      <td>{{orderDetail?.StrainName}}</td>                      
                      <td>
                          <p-table [value]="displayPkgDetails(orderDetail)">
                              <ng-template pTemplate="header">
                                  <tr>                                      
                                    <th>Oil Pkg. Code</th>
                                    <th>TP Pkg. Type</th>                                    
                                    <th >Selected Oil Wt.</th>
                                    <th *ngIf="TaskModel?.TaskStatus == taskStatus.ReviewPending||TaskModel?.TaskStatus == taskStatus.Completed">
                                      {{assignTaskResources.completedwt}}
                                    </th>
                                    <!-- <th *ngIf="TaskModel?.TaskStatus == taskStatus.ReviewPending||TaskModel?.TaskStatus == taskStatus.Completed">
                                      {{assignTaskResources.compreturnwt}}
                                    </th> -->
                                    <th *ngIf="showToManager">{{assignTaskResources.reviewedwt}}</th>
                                    <!-- <th *ngIf="showToManager">{{assignTaskResources.revreturnwt}}</th> -->
                                  </tr>
                              </ng-template>
                              <ng-template pTemplate="body" let-pkgDetails >
                                  <tr>                                      
                                      <td>{{pkgDetails.OilPkgCode}}</td>
                                      <td>{{pkgDetails.TPPkgTypeName}}</td>                                      
                                      <td>{{pkgDetails.AssignedOilWt}}</td>
                                      <td *ngIf="TaskModel?.TaskStatus == taskStatus.ReviewPending||TaskModel?.TaskStatus == taskStatus.Completed">
                                          {{pkgDetails.ProcessedOilWt}} {{globalResource.listgramunit}}
                                      </td>
                                      <!-- <td *ngIf="TaskModel?.TaskStatus == taskStatus.ReviewPending||TaskModel?.TaskStatus == taskStatus.Completed">
                                        {{pkgDetails?.ReturnWt}}{{globalResource.listgramunit}}
                                      </td> -->
                                      <td *ngIf="showToManager">{{pkgDetails?.RevProcessedOilWt}}{{globalResource.listgramunit}}</td>
                                      <!-- <td *ngIf="showToManager">{{pkgDetails?.RevReturnWt}}{{globalResource.listgramunit}}</td> -->
                                  </tr>
                              </ng-template>
                              <ng-template pTemplate="emptymessage">
                                <tr>
                                    <td [attr.colspan]="3">
                                      {{ globalResource.norecordsfound }}
                                    </td>
                                </tr>
                              </ng-template>
                          </p-table>                          
                      </td>
                  </tr>
              </ng-template>
          </p-table>
        </div>

        <!-- completion parameter -->  
     <div 
     *ngIf="TaskModel?.TaskStatus == taskStatus.ReviewPending||TaskModel?.TaskStatus == taskStatus.Completed"
     class="ui-grid ui-grid-responsive ui-grid-pad ui-fluid" 
     style="margin: 10px 0px; width:100%;">
           <div class="ui-grid-row">
             <div class="ui-grid-col-4">
 
             </div>
             <div class="ui-grid-col-4">
                 <strong>Task Owner</strong>
             </div>
             <div class="ui-grid-col-4" *ngIf="showToManager">
               <strong>Reviewer</strong>
             </div>
           </div>
 
          <!-- Emp Act Hrs -->
          <div class="ui-grid-row">
              <div class="ui-grid-col-4">
                  <strong>{{ globalResource.actualhrs }} :</strong>
              </div>
              <div class="ui-grid-col-4">
                  {{ TaskModel?.ActHrs | minutesToTime }}
              </div>
              <div class="ui-grid-col-4" *ngIf="showToManager">                
                  {{ taskReviewModel?.racthrs | minutesToTime }}
              </div> 
          </div>
          <!-- End Act Hrs -->

   </div>             
 <!--End completion parameter -->
  </div>

  <p-dialog 
    header="Task Completion" 
    [(visible)]="PageFlag.showmodal" 
    modal="modal" 
    [resizable]="true" 
    [responsive]="true" 
    [width]="750"
     [minWidth]="200"
  >
    <form [formGroup]="completionForm" (ngSubmit)="submitCompleteParameter(completionForm.value)" formSubmit>        
      <div formArrayName="completeParamArr">
        <div class="ui-grid-row" *ngFor="let comp of completeParamArr?.controls; let i=index">                         
            <p-panel
              [toggleable]="true" 
              [style]="{'margin-bottom':'20px','width': '100%'}"
              [formGroupName]="i"
              [expandIcon]="'fa fa-chevron-left'"
              [collapseIcon]="'fa fa-chevron-down'"
            >
            <p-header class="accordionHeader">  
              <div class="ui-helper-clearfix"  >
                <p class="panel-titleCompletion">
                  <span class="ui-panel-title" style="font-size:16px;display:inline-block;margin-top:2px">
                      <span pTooltip="Brand Name">{{ TaskModel.AssignQtyDetails[i].BrandName }}</span> : <span pTooltip="Sub-Brand">{{ TaskModel.AssignQtyDetails[i].SubBrandName }}</span> 
                      : <span pTooltip="Strain Name">{{ TaskModel.AssignQtyDetails[i].StrainName }}</span> 
                      : <span pTooltip="Pkg Type Name">{{ TaskModel.AssignQtyDetails[i].PkgTypeName }}</span> : <span pTooltip="Package Size">{{ TaskModel.AssignQtyDetails[i].UnitValue }}{{globalResource.listgramunit}}</span> 
                      <!-- : <span pTooltip="Item Qty">{{ TaskModel.AssignQtyDetails[i].ItemQty }}</span>                          -->
                  </span>

                  <span class="ui-panel-title" style="font-size:16px;display:inline-block;margin-top:2px">                    
                    Assign Qty:{{ TaskModel.AssignQtyDetails[i].AssignedQty }} 
                </span>
              </p>    
              <div style="display: inline-block;vertical-align: top;">
                <input                    
                    type="text"
                    pTooltip="Package Code"
                    pInputText
                    autocomplete="off"
                    pKeyFilter="alphanum"                                   
                    placeholder="Package Code"
                    formControlName="packageCode"
                    id="packagecode"
                    name="packagecode"   
                    class="reviewedQty"
                  />
                  <div class="ui-message ui-messages-error ui-corner-all" appErrorTooltip
                  *ngIf="!comp.controls['packageCode'].valid&&comp.controls['packageCode'].dirty">
                    <!-- <span *ngIf="comp.controls['packageCode'].errors['required']">
                      {{ globalResource.pkgcoderequire }}
                    </span> -->
                    <span *ngIf="comp.controls['packageCode'].hasError('duplicatepkgcode')">
                        {{ assignTaskResources.duplicatePackageCode }}
                    </span>
                </div>
              </div> 

              <div style="display: inline-block;vertical-align: top;">
                   <input                    
                      type="number"
                      pTooltip="Completed Qty"
                      pKeyFilter="pint"            
                      pInputText
                      autocomplete="off"
                      [(ngModel)]="disableCompletedQtyArr[i]"                   
                      placeholder="Completed Qty"
                      formControlName="completedQty"  
                      (change)="compQtyOnChange(i, comp)"                                          
                      id="completedqty"
                      name="completedqty"   
                      class="reviewedQty"
                  />
                  <div class="ui-message ui-messages-error ui-corner-all" appErrorTooltip
                      *ngIf="!comp.controls['completedQty'].valid&&comp.controls['completedQty'].dirty">
                      <span *ngIf="comp.controls['completedQty'].hasError('pkgqtynotmatched')">
                          {{ assignTaskResources.pkgqtynotmatched }}
                      </span>
                      <span *ngIf="comp.controls['completedQty'].hasError('max')">
                          {{ assignTaskResources.compqtygreaterassignqty }}
                      </span>
                </div>
              </div>
              </div>
            </p-header>
            
           <div formArrayName="PkgDetails" class="panel-content" >
            <table class="table table-bordered">
              <thead>
                <tr>
                  <th>{{ globalResource.oilpkgcode }}</th>
                  <th>{{ globalResource.assignwt }}</th>
                  <th>{{ globalResource.pkgcompletedqty }}</th>
                  <th>{{ globalResource.completedwt }}</th>
                  <th>{{ globalResource.balancedwt }}</th>
                </tr>
              </thead>                 
              <tbody >
                <tr *ngFor="let OilPkg of pkgInnerFormArray(comp).controls; let j=index;" [formGroupName]="j">                                                                
                      <td  pTooltip="{{ globalResource.oilpkgcode }}" style="width:205px;">                                                      
                        <label>
                            {{ OilPkg.value.oilPkgCode }}
                        </label>
                      </td>
                      <td pTooltip="{{ globalResource.assignwt }}" >    
                        <label>{{ OilPkg.value.assignedOilWt }}</label>
                      </td>
                        <td>    
                        <input  
                          pInputText
                          autocomplete="off"                 
                          type="number"                                                  
                          pKeyFilter="int"                                                   
                          (change)="calculateTotalCompletedWt(i, comp, OilPkg)" 
                          maxlength="AppConstants.maxLength"
                          placeholder="Packages Completed"
                          formControlName="pkgCompletedQty"                                            
                          id="pkgcompletedqty"
                          name="pkgcompletedqty"                      
                        />                     
                    
                      </td>   
                      <td pTooltip="Completed Weight" >    
                          <label>{{ pkgMap.get(OilPkg.value.oilPkgId) || 0 }}{{globalResource.listgramunit}}</label>
                      </td>
                      <td pTooltip="Balanced Weight" >    
                          <label>{{ pkgBalancedWtMap.get(OilPkg.value.oilPkgId) || 0 }}{{globalResource.listgramunit}}</label>
                      </td>      
                </tr>
              </tbody>
        </table> 
          </div>
        <!-- Pkg Mixing -->
        <!-- <div class="divPkgMixing panel-content" formArrayName="MixPkgDetails" *ngIf="comp.value.completedQty > 0 && pkgInnerFormArray(comp).controls.length > 1">
          <strong><span class="ui-dialog-title">{{ assignTaskResources.mixpkgdetails }}</span></strong>
          <hr>

          <table class="table table-bordered">
              <thead>
                <tr>
                    <th>{{ globalResource.no }} </th>
                    <th>{{ globalResource.pkg }} </th>                                        
                    <th>{{ globalResource.pkgdetails }}</th> 
                    <th></th>
                </tr>
              </thead>                 
              <tbody>
                <tr *ngFor="let mixPkg of mixPkgDetailsArr(comp).controls; let k=index;" [formGroupName]="k">                                                                    
                    <td style="width:5%;">                                                      
                      <label>
                          {{ k + 1 }}                                         
                      </label>
                    </td>
                    <td style="width:30%;">    
                      <label>{{ globalResource.pkg }} {{ (k + 1) | number:'2.0-0' }}</label>
                    </td>
                    <td style="width:60%;">                                      
                        <p-table [value]="selectedMixPkgsArray[i +''+ k]">
                            <ng-template pTemplate="header">
                                <tr>
                                    <th>{{globalResource.oilpkgcode}}</th>
                                    <th>{{globalResource.selectedwt}}</th>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-pkgDetails>
                                <tr>
                                    <td>
                                        {{pkgDetails?.oilPkgCode}}                                       
                                    </td>
                                    <td>{{pkgDetails?.selectedOilWt}} {{globalResource.listgramunit}}</td>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="emptymessage">
                                <tr>
                                    <td [attr.colspan]="2">
                                      {{globalResource.nopkgselected}}
                                    </td>
                                </tr>
                            </ng-template>
                        </p-table>                        
                        <span>
                            <a class="btn-link" [routerLink]="" (click)="openMixPkgSelection(mixPkg, k, i)" >Select Pkgs</a>
                        </span>  
                    </td>  
                    <td style="width:5%;">    
                        <a (click)="deleteItem(comp, i, k)" >                                  
                            <span class="fa fa-minus-circle">
                            </span>
                        </a>          
                    </td>   
                </tr>
              </tbody>
          </table> 
          <a class="addbtn" [routerLink]="" (click)="addItem(comp,mixPkg)">
              <span class="fa fa-plus-circle">
              </span>
          </a>
      </div> -->
      <!-- End Of Pkg Mixing -->
      </p-panel>
    </div>

          <!-- <pre>{{completionForm.value | json}}</pre> -->
        </div>

         <!-- Return Weight Entries -->
          <div class="ui-g-12"   *ngIf="pkgReturnWtArr?.controls.length && EnabledReturnwtbox" formArrayName="pkgReturnWtArr">
          <h5>Pkg Return Weight Details</h5>
          <p-table [value]="pkgReturnWtArr?.controls">
              <ng-template pTemplate="header">
                  <tr>
                      <th>{{globalResource.oilpkgcode}}</th>
                      <th>{{globalResource.strain}}</th>
                      <th>{{assignTaskResources.tppkgtypename}}</th>
                      <th>{{assignTaskResources.assignedwt}}</th>
                      <th>{{assignTaskResources.processedwt}}</th>                                    
                      <th>{{assignTaskResources.returnwt}}</th>
                  </tr>
              </ng-template>
              <ng-template pTemplate="body" let-returnObject let-i="rowIndex" >
                  <tr [formGroupName]="i">
                      <td>{{  returnObject.value.OilPkgCode}}</td>
                      <td>{{  returnObject.value.StrainName}}</td>
                      <td>{{  returnObject.value.TPPkgTypeName}}</td>                         
                      <td>{{ returnObject.value.AssignedOilWt || 0 }} {{globalResource.listgramunit}}</td>                        
                      <td>{{ pkgMap.get(returnObject.value.OilPkgId) || 0 }} {{globalResource.listgramunit}}</td>                      
                      <td>
                        <input
                          type="number"                                               
                          pKeyFilter="num"                     
                          pInputText                        
                          formControlName="pkgReturnedWt"
                          id="answer"
                          name="answer"
                          style="width:100%;"
                        />
                        <div appErrorTooltip class="ui-message ui-messages-error ui-corner-all"
                          *ngIf="!returnObject.controls['pkgReturnedWt'].valid&&returnObject.controls['pkgReturnedWt'].dirty
                          && returnObject.controls['pkgReturnedWt'].errors['required']"
                          >
                            <span *ngIf="returnObject.controls['pkgReturnedWt'].errors['required']">
                              {{ assignTaskResources.returnwt }} {{ globalResource.isrequiredmsg }}
                            </span>
                        </div>
                      </td>
                  </tr>
              </ng-template>
              <ng-template pTemplate="emptymessage" let-columns>
                <tr>
                    <td [attr.colspan]="3">
                       {{ globalResource.norecordsfound }}
                    </td>
                </tr>
              </ng-template>
          </p-table>
        </div>  
        <!-- End of Return Weight Entries -->
          
        <div class="ui-grid ui-grid-responsive ui-grid-pad ui-fluid" style="margin: 10px 0px">              
              <div class="ui-grid-row">
                 
                  <div class="ui-grid-col-4 text-right">
                    {{ assignTaskResources.comment }} :
                  </div>
                  <div class="ui-grid-col-5">
                      <textarea                        
                        pInputTextarea                 
                        formControlName="MiscComment"
                        id="misccomment"
                        name="misccomment"
                        maxlength="500"
                        class="clsControl"                  
                      ></textarea>
                  </div> 
                 
              </div>
          </div>
      <p-footer>
          <!-- [disabled]="!completionForm.valid" -->
        <button type="submit" pButton icon="fa-check"  label="Confirm" ></button>
        <!-- [disabled]="!completionForm.valid" -->
        <button type="button" class="ui-button-secondary" pButton icon="fa-close" (click)="PageFlag.showmodal=false" label="Cancel"></button>
      </p-footer>
  </form>
</p-dialog>

<!-- Task Review Model -->
<p-dialog header="Submit Review" [(visible)]="PageFlag.showReviewmodal" modal="modal" [resizable]="true" [responsive]="true" [width]="750" [minWidth]="200" >
  <form [formGroup]="reviewForm" (ngSubmit)="submitReviewParameter(reviewForm.value)" formSubmit>

      <div formArrayName="reviewParamArr">
          <div class="ui-grid-row" *ngFor="let comp of reviewParamArr?.controls; let i=index">                         
              <p-panel
                [toggleable]="true" 
                [style]="{'margin-bottom':'20px','width': '100%'}"
                [formGroupName]="i"
                [expandIcon]="'fa fa-chevron-left'"
                [collapseIcon]="'fa fa-chevron-down'"
              >
              <p-header class="accordionHeader">  
                <div class="ui-helper-clearfix"  >
                  <p class="panel-titleCompletion">
                    <span class="ui-panel-title" style="font-size:16px;display:inline-block;margin-top:2px">
                        <span pTooltip="Brand Name">{{ TaskModel.AssignQtyDetails[i].BrandName }}</span> : <span pTooltip="Sub-Brand">{{ TaskModel.AssignQtyDetails[i].SubBrandName }}</span> 
                        : <span pTooltip="Strain Name">{{ TaskModel.AssignQtyDetails[i].StrainName }}</span> 
                        : <span pTooltip="Pkg Type Name">{{ TaskModel.AssignQtyDetails[i].PkgTypeName }}</span> : <span pTooltip="Package Size">{{ TaskModel.AssignQtyDetails[i].UnitValue }}{{globalResource.listgramunit}}</span> 
                        <!-- : <span pTooltip="Item Qty">{{ TaskModel.AssignQtyDetails[i].ItemQty }}</span>                          -->
                    </span>
  
                    <span class="ui-panel-title" style="font-size:16px;display:inline-block;margin-top:2px">                    
                      Assign Qty:{{ TaskModel.AssignQtyDetails[i].CompletedQty }} 
                    </span>

                    <span class="ui-panel-title" style="font-size:16px;display:inline-block;margin-top:2px"
                      pTooltip="Package Code"
                      >                    
                        Pkg Code: {{ TaskModel.AssignQtyDetails[i].PackageCode }} 
                    </span>
                </p>    
                <div style="display: inline-block;vertical-align: top;">
                    <input                    
                      type="number"
                      OnlyNumber="true"            
                      pInputText
                      autocomplete="off"
                      [(ngModel)]="disableCompletedQtyArr[i]"
                      readonly="true"
                      placeholder="Reviewed Qty"
                      formControlName="reviewedQty"                                            
                      id="reviewedqty"
                      name="reviewedqty"   
                      class="reviewedQty"
    
                    />                   
                </div> 
                </div>
              </p-header>
              
             <div formArrayName="PkgDetails" class="panel-content" >
              <table class="table table-bordered">
                <thead>
                  <tr>
                    <th>{{ globalResource.oilpkgcode }}</th>
                    <th>{{ globalResource.assignwt }}</th>
                    <th>{{ globalResource.pkgcompletedqty }}</th>
                    <th>{{ globalResource.completedwt }}</th>
                    <th>{{ globalResource.balancedwt }}</th>
                  </tr>
                </thead>                 
                <tbody>
                  <tr *ngFor="let OilPkg of pkgInnerFormArray(comp).controls; let j=index;" [formGroupName]="j">                                                                
                        <td  pTooltip="{{ globalResource.oilpkgcode }}" style="width:205px;">                                                      
                          <label>
                              {{ OilPkg.value.oilPkgCode }}
                          </label>
                        </td>
                        <td pTooltip="{{ globalResource.assignwt }}" >    
                          <label>{{ OilPkg.value.assignedOilWt }}</label>
                        </td>
                          <td>    
                          <input  
                            pInputText
                            autocomplete="off"                 
                            type="number" 
                            readonly="true"                                                 
                            pKeyFilter="int"                                                   
                            (change)="calculateTotalReviewedWt(i, comp, OilPkg)"
                            maxlength="AppConstants.maxLength"
                            placeholder="Packages Completed"
                            formControlName="pkgReviewedQty"                                            
                            id="pkgReviewedQty"
                            name="pkgReviewedQty"                      
                          />                     
                      
                        </td>   
                        <td pTooltip="Completed Weight" >                           
                            <label>{{ pkgMap.get(OilPkg?.value.oilPkgId) || 0 }}{{globalResource.listgramunit}}</label>
                        </td>
                        <td pTooltip="Balanced Weight" >    
                            <label>{{ pkgBalancedWtMap.get(OilPkg?.value.oilPkgId) || 0 }}{{globalResource.listgramunit}}</label>
                        </td>      
                  </tr>
                </tbody>
          </table> 
            </div>    
          <!-- Pkg Mixing -->
          <!-- <div class="divRevPkgMixing panel-content" formArrayName="MixPkgDetails" *ngIf="comp?.value?.reviewedQty > 0&&mixPkgDetailsArr(comp).controls.length > 0">
            <strong><span class="ui-dialog-title">{{ assignTaskResources.mixpkgdetails }}</span></strong>
            <hr>
  
            <table class="table table-bordered">
                <thead>
                  <tr>
                      <th>{{ globalResource.no }} </th>
                      <th>{{ globalResource.pkg }} </th>                                        
                      <th>{{ globalResource.pkgdetails }}</th>                      
                  </tr>
                </thead>                 
                <tbody>
                  <tr *ngFor="let mixPkg of mixPkgDetailsArr(comp).controls; let k=index;" [formGroupName]="k">                                                                    
                      <td style="width:5%;">                                                      
                        <label>
                            {{ k + 1 }}                                         
                        </label>
                      </td>
                      <td style="width:30%;">    
                        <label>{{ globalResource.pkg }} {{ (k + 1) | number:'2.0-0' }}</label>
                      </td>
                      <td style="width:60%;">  

                          <p-table [value]="selectedMixPkgsArray[i +''+ k]">
                              <ng-template pTemplate="header">
                                  <tr>
                                      <th>{{globalResource.oilpkgcode}}</th>
                                      <th>{{globalResource.selectedwt}}</th>
                                  </tr>
                              </ng-template>
                              <ng-template pTemplate="body" let-pkgDetails>
                                  <tr>
                                      <td>
                                          {{pkgDetails?.oilPkgCode}}                                       
                                      </td>
                                      <td>{{pkgDetails?.selectedOilWt}} {{globalResource.listgramunit}}</td>
                                  </tr>
                              </ng-template>
                              <ng-template pTemplate="emptymessage">
                                  <tr>
                                      <td [attr.colspan]="2">
                                        {{globalResource.nopkgselected}}
                                      </td>
                                  </tr>
                              </ng-template>
                          </p-table>
                      </td>  
                  </tr>
                </tbody>
            </table> 
        </div> -->
        <!-- End Of Pkg Mixing -->
        </p-panel>
      </div>
  
            <!-- <pre>{{completionForm.value | json}}</pre> -->
          </div>

      <!-- Return Weight Entries -->
       <div class="ui-g-12" *ngIf="pkgReturnWtRevArr?.controls.length && EnabledReturnwtbox" formArrayName="pkgReturnWtArr">
        <h5>Pkg Return Weight Details</h5>
        <p-table [value]="pkgReturnWtRevArr?.controls">
            <ng-template pTemplate="header">
                <tr>
                    <th>{{globalResource.oilpkgcode}}</th>
                    <th>{{globalResource.strain}}</th>
                    <th>{{assignTaskResources.tppkgtypename}}</th>
                    <th>{{assignTaskResources.assignedwt}}</th>
                    <th>{{assignTaskResources.processedwt}}</th>                                    
                    <th>{{assignTaskResources.returnwt}}</th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-returnObject let-i="rowIndex" >
                <tr [formGroupName]="i">
                    <td>{{  returnObject.value.OilPkgCode}}</td>
                    <td>{{  returnObject.value.StrainName}}</td>
                    <td>{{  returnObject.value.TPPkgTypeName}}</td>                         
                    <td>{{ returnObject.value.AssignedOilWt || 0 }} {{globalResource.listgramunit}}</td>                        
                    <td>{{ pkgMap.get(returnObject?.value.OilPkgId) || 0 }} {{globalResource.listgramunit}}</td>                    
                    <td>
                      <input
                        type="number"                                               
                        pKeyFilter="num"                     
                        pInputText                        
                        formControlName="pkgReturnedWt"
                        id="answer"
                        name="answer"
                        style="width:100%;"
                      />
                      <div appErrorTooltip class="ui-message ui-messages-error ui-corner-all"
                        *ngIf="!returnObject.controls['pkgReturnedWt'].valid&&returnObject.controls['pkgReturnedWt'].dirty
                        && returnObject.controls['pkgReturnedWt'].errors['required']"
                        >
                          <span *ngIf="returnObject.controls['pkgReturnedWt'].errors['required']">
                            {{ assignTaskResources.returnwt }} {{ globalResource.isrequiredmsg }}
                          </span>
                      </div>
                    </td>
                </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage" let-columns>
              <tr>
                  <td [attr.colspan]="3">
                     {{ globalResource.norecordsfound }}
                  </td>
              </tr>
            </ng-template>
        </p-table>
      </div> 
      <!-- End of Return Weight Entries -->

      <div class="ui-grid ui-grid-responsive ui-grid-pad ui-fluid" style="margin: 10px 0px">
          <div class="ui-grid-row">
             
            <div class="ui-grid-col-3 text-right">
              {{ assignTaskResources.actualhrs }} :
            </div>
            <div class="ui-grid-col-4">
                {{ TaskModel?.ActHrs | minutesToTime }}
            </div>
            <div class="ui-grid-col-5">
                 <!-- <p-calendar 
                  required 
                  name="acthrs"
                  [stepHour]="1" 
                  [stepMinute]="15" 
                  [timeOnly]="true" 
                  [showTime]="true" 
                  formControlName="ActHrs"
                  hourFormat="24">
                </p-calendar> -->

                <div class="ui-inputgroup ui-inputgroup-border" >
                    <input type="number"                   
                        pInputText 
                        autocomplete="off"
                        [(ngModel)]="taskReviewModel.racthrs"                         
                        formControlName="ActHrs"
                        pKeyFilter="int"
                        id="acthrs"
                        name="acthrs"                      
                      /> 
                      <span>:</span>
                      <input type="number"                  
                        pInputText     
                        autocomplete="off"              
                        [(ngModel)]="taskReviewModel.ractmins"                         
                        formControlName="ActMins"
                        pKeyFilter="int"
                        id="actmins"
                        name="actmins"                      
                      />
                      <!-- Added by Devdan :: Sec to Min change :: 06-Nov-2018 -->
                      <div class="ui-message ui-messages-error ui-corner-all" appErrorTooltip
                        *ngIf="!reviewForm.controls['ActMins'].valid&&reviewForm.controls['ActMins'].dirty">
                          <span *ngIf="reviewForm.controls['ActMins'].errors['max']">
                            {{ globalResource.maxMinSecValue }}
                          </span>
                      </div>
                      <!-- ADDED BY DEVDAN :: 06-NOV-2018 :: ADDING TEXTBOX FOR SECONDS -->
                      <span>:</span>
                      <input type="number"                  
                        pInputText         
                        autocomplete="off"      
                        pKeyFilter="int"    
                        [(ngModel)]="taskReviewModel.ractsecs"                         
                        formControlName="ActSecs"
                        id="actsecs"
                        name="actsecs"                  
                      />
                      <div class="ui-message ui-messages-error-Sec ui-corner-all" appErrorTooltip
                        *ngIf="!reviewForm.controls['ActSecs'].valid&&reviewForm.controls['ActSecs'].dirty">
                          <span *ngIf="reviewForm.controls['ActSecs'].errors['max']">
                            {{ globalResource.maxMinSecValue }}
                          </span>
                      </div>
                      <!-- END :: Sec to Min change :: 06-Nov-2018 -->
                  </div>
            </div> 
           
        </div>
          <div class="ui-grid-row">
               
              <div class="ui-grid-col-3 text-right">
                {{ assignTaskResources.misccost }} :
              </div>
              <div class="ui-grid-col-4">
                  {{ TaskModel?.MiscCost  | currency  }}
              </div>
              <div class="ui-grid-col-5">
                  <input type="text"
                    OnlyNumber="true" 
                    pInputText     
                    autocomplete="off" 
                    pKeyFilter="num"                         
                    formControlName="MiscCost"
                    id="misccost"
                    name="misccost"      
                  />               
              </div> 
             
          </div>

          <div class="ui-grid-row">
             
              <div class="ui-grid-col-3 text-right">
                {{ assignTaskResources.comment }} :
              </div>
              <div class="ui-grid-col-4">
                 {{ TaskModel?.Comments }}
              </div>
              <div class="ui-grid-col-5">
                  <textarea                        
                    pInputTextarea                 
                    formControlName="MiscComment"
                    id="misccomment"
                    name="misccomment"
                    maxlength="500"
                    class="clsControl"                  
                  ></textarea>
              </div> 
             
          </div>
      </div>
    <p-footer>
        <!-- [disabled]="!completionForm.valid" -->
      <button type="submit" pButton icon="fa-check"  label="Confirm" ></button>
      <!-- [disabled]="!reviewForm.valid" -->
      <button type="button" class="ui-button-secondary" pButton icon="fa-close" (click)="PageFlag.showReviewmodal=false" label="Cancel"></button>
    </p-footer>
</form>
</p-dialog>
<!-- End of Task Review Model -->

<p-dialog header="Select Pkgs"
    [(visible)]="showMixPkgSelectionModel"
    modal="modal"
    [resizable]="true"
    [responsive]="true" [width]="600" [minWidth]="300"  >

    <form [formGroup]="questionForm" (ngSubmit)="submitMixPkgDetails(questionForm)" formSubmit >
          <!-- (ngSubmit)="submit(questionForm)" -->
    <div class="ui-grid ui-grid-responsive ui-grid-pad ui-fluid" style="margin: 10px 0px">

      <div class="ui-g">
              <div class="ui-g-12 ui-md-4">
                  <label>
                    <strong>Genetics</strong>
                  </label>

                  <label>
                    {{ selMixPkgPkgRow?.GeneticsName }}
                  </label>
                </div>
                <!-- <div class="ui-g-12 ui-md-4">
                    <label>
                      <strong>{{globalResource.strain}}</strong>
                    </label>
  
                    <label>
                      {{ selMixPkgPkgRow?.StrainName }}
                    </label>
                  </div> -->

                <div class="ui-g-12 ui-md-4">
                    <label>
                      <strong>{{globalResource.requirewt}}</strong>
                    </label>

                    <label>
                      {{ selMixPkgPkgRow?.RequireWt }} {{globalResource.measure}}
                    </label>
                  </div>

        </div>
        <div formArrayName="questions">
          
        <p-table [value]="questions?.controls" id="tblMixPkgSelection">
            <ng-template pTemplate="header">
                <tr>
                    <th style="width:150px">Strain</th>
                    <th style="width:150px">{{globalResource.oilpkgcode}}</th>
                    <th style="width:20.33333333%">{{globalResource.completedwt}}</th>
                    <th style="width:20.33333333%">{{globalResource.balancedwt}}</th>
                    <th style="width:20.33333333%">{{globalResource.selectedwt}}</th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-question let-i="rowIndex" >
                <tr [formGroupName]="i">
                    <td style="width:150PX" >    
                        <label>{{ question?.value.StrainName}}</label>
                    </td>
                    <td style="width:150PX">
                        <p-checkbox
                          label="{{ question?.value.oilPkgCode  }}"
                          formControlName="question"
                          (ngModelChange)="changeValidator($event, i)"
                          binary="true"
                        ></p-checkbox> 
                    </td>
                    <td pTooltip="Completed Weight" >    
                        <label>{{ pkgMap.get(question?.value.oilPkgId) || 0 }}{{globalResource.listgramunit}}</label>
                    </td>
                    <td pTooltip="Balanced Weight" >    
                        <label>{{ pkgBalancedWtMap.get(question?.value.oilPkgId) || 0 }}{{globalResource.listgramunit}}</label>
                    </td> 
                    <td>
                      <input
                        type="number"
                        OnlyNumber="true"
                        pInputText
                        autocomplete="off"
                        formControlName="answer"
                        id="answer"
                        name="answer"
                        style="width:100%;"
                      />

                      <div
                        class="ui-message ui-messages-error ui-corner-all" appErrorTooltip
                        *ngIf="!question.controls['answer'].valid&&question.controls['answer'].dirty">
                          <span *ngIf="question.controls['answer'].hasError('oilpkgmaxwtexceeded')">
                          <!-- max lot wt exceeded -->
                          </span>
                    </div>
                      <!-- (change)="CalculateMixLotWt(question, 'SPECIFIC')" -->
                    </td>
                </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage">
              <tr>
                  <td [attr.colspan]="3">
                    {{ assignTaskResources.nopkgpresent }} "{{ SelLotBrandStrainRow?.StrainName }}".
                  </td>
              </tr>
            </ng-template>
        </p-table>
        </div>              
      </div>
      <p-footer class="text-right">

        <button type="submit"  pButton icon="fa-check"  label="Confirm" id="btnMixPkgSelectionConfirm" name="btnMixPkgSelectionConfirm" ></button>
        <!-- [disabled]="questionForm.invalid" -->
        <button type="button" pButton icon="fa-close" (click)="showMixPkgSelectionModel=false" label="Cancel"></button>
    </p-footer>
  </form>
</p-dialog>
  </div>
  <p-growl [(value)]="msgs" life='5000' ></p-growl>